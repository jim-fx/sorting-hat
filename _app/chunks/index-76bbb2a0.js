class I{constructor(t,s,o){this.set(t,s,o)}toString(){return`rgb(${Math.round(this.r)}, ${Math.round(this.g)}, ${Math.round(this.b)})`}set(t,s,o){this.r=this.clamp(t),this.g=this.clamp(s),this.b=this.clamp(o)}hueRotate(t=0){t=t/180*Math.PI;const s=Math.sin(t),o=Math.cos(t);this.multiply([.213+o*.787-s*.213,.715-o*.715-s*.715,.072-o*.072+s*.928,.213-o*.213+s*.143,.715+o*.285+s*.14,.072-o*.072-s*.283,.213-o*.213-s*.787,.715-o*.715+s*.715,.072+o*.928+s*.072])}grayscale(t=1){this.multiply([.2126+.7874*(1-t),.7152-.7152*(1-t),.0722-.0722*(1-t),.2126-.2126*(1-t),.7152+.2848*(1-t),.0722-.0722*(1-t),.2126-.2126*(1-t),.7152-.7152*(1-t),.0722+.9278*(1-t)])}sepia(t=1){this.multiply([.393+.607*(1-t),.769-.769*(1-t),.189-.189*(1-t),.349-.349*(1-t),.686+.314*(1-t),.168-.168*(1-t),.272-.272*(1-t),.534-.534*(1-t),.131+.869*(1-t)])}saturate(t=1){this.multiply([.213+.787*t,.715-.715*t,.072-.072*t,.213-.213*t,.715+.285*t,.072-.072*t,.213-.213*t,.715-.715*t,.072+.928*t])}multiply(t){const s=this.clamp(this.r*t[0]+this.g*t[1]+this.b*t[2]),o=this.clamp(this.r*t[3]+this.g*t[4]+this.b*t[5]),e=this.clamp(this.r*t[6]+this.g*t[7]+this.b*t[8]);this.r=s,this.g=o,this.b=e}brightness(t=1){this.linear(t)}contrast(t=1){this.linear(t,-(.5*t)+.5)}linear(t=1,s=0){this.r=this.clamp(this.r*t+s*255),this.g=this.clamp(this.g*t+s*255),this.b=this.clamp(this.b*t+s*255)}invert(t=1){this.r=this.clamp((t+this.r/255*(1-2*t))*255),this.g=this.clamp((t+this.g/255*(1-2*t))*255),this.b=this.clamp((t+this.b/255*(1-2*t))*255)}hsl(){const t=this.r/255,s=this.g/255,o=this.b/255,e=Math.max(t,s,o),i=Math.min(t,s,o);let r,h,a=(e+i)/2;if(e===i)r=h=0;else{const l=e-i;switch(h=a>.5?l/(2-e-i):l/(e+i),e){case t:r=(s-o)/l+(s<o?6:0);break;case s:r=(o-t)/l+2;break;case o:r=(t-s)/l+4;break}r/=6}return{h:r*100,s:h*100,l:a*100}}clamp(t){return t>255?t=255:t<0&&(t=0),t}}function A(n){var t={},s,o=0,e,i,r=0,h,a="",l=String.fromCharCode,d=n.length,_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(s=0;s<64;s++)t[_.charAt(s)]=s;for(i=0;i<d;i++)for(e=t[n.charAt(i)],o=(o<<6)+e,r+=6;r>=8;)((h=o>>>(r-=8)&255)||i<d-2)&&(a+=l(h));return a}function y(n){if(!n)return{};const t=n.split(".")[1],s=t==null?void 0:t.replace(/-/g,"+").replace(/_/g,"/");if(!s)return{};const o=A(s);return JSON.parse(o)}function L(n){return n[0].toUpperCase()+n.slice(1)}function g(n){return n&&typeof n=="object"&&!Array.isArray(n)}function m(n,...t){if(!t.length)return n;const s=t.shift();if(g(n)&&g(s))for(const o in s)g(s[o])?(n[o]||Object.assign(n,{[o]:{}}),m(n[o],s[o])):Object.assign(n,{[o]:s[o]});return m(n,...t)}new I;function V(n){return n<.5?16*n*n*n*n*n:1-Math.pow(-2*n+2,5)/2}const{VITE_API_URL:M=""}={VITE_API_URL:"https://si21.herokuapp.com",VITE_SVELTEKIT_AMP:"",BASE_URL:"/_app/",MODE:"production",DEV:!1,PROD:!0};let p;const c={};function O(n){if(n in c)return c[n].forEach(t=>t());try{const{type:t,data:s}=JSON.parse(n);if(console.groupCollapsed("ws:received "+t,t in c),console.log(s),console.log(c),console.groupEnd(),t in c)return c[t].forEach(o=>o(s))}catch(t){console.error(t)}}let w;function u(){if(!("WebSocket"in globalThis))return;let n=M||window.location.host;const t=window.location.protocol.includes("s");let s=new WebSocket(`ws${t?"s":""}://`+n.replace("https://","").replace("http://",""));s.onmessage=e=>{O(e.data)};let o;return w=new Promise(e=>{o=e}),s.onopen=()=>{console.log("Websocket Connected"),o(),setTimeout(()=>{"open"in c&&c.open.forEach(e=>e(s))},50),o()},s.onclose=()=>{setTimeout(async()=>{console.log("Reconnecting"),p=u()},500)},s}function P(n,t){return p||(p=u()),c[n]=n in c?[...c[n],t]:[t],()=>{c[n]=c[n].filter(s=>s!==t)}}async function k(n,t){p||(p=u()),await w,p.send(JSON.stringify({type:n,data:t}))}const{VITE_API_URL:S=""}={VITE_API_URL:"https://si21.herokuapp.com",VITE_SVELTEKIT_AMP:"",BASE_URL:"/_app/",MODE:"production",DEV:!1,PROD:!0};let f,b=!1;async function E(n,{method:t,body:s,token:o}){const e={method:t};s&&(e.body=JSON.stringify(s));let i="localStorage"in globalThis?localStorage.getItem("jwt"):"";o&&(i=o),i&&(e.headers={Authentication:`Bearer ${o||i}`}),t==="POST"&&s&&("headers"in e||(e.headers={}),e.headers["Content-Type"]="application/json");const r=(S?S+"/":"/")+n;console.groupCollapsed("send."+t.toLowerCase(),r),console.log({body:s,token:o,headers:e.headers}),console.groupEnd();const h=await fetch(r,e);return console.log(h,f),h.status===401&&f&&(b=!0,f.update(a=>(a.role="",a))),h}function j(n,t){return E(n,{method:"GET",token:t})}function T(){if("jwt"in localStorage&&f){if(b)return;const{jwt:n}=localStorage,{role:t}=y(n);console.log("registerWsAdmin"),t==="ADMIN"&&(f.update(s=>(s.role=t,s)),k("admin",n))}}P("open",()=>{T()});function C(n){f=n,T()}function R(n,t,s){return E(n,{method:"POST",body:t,token:s})}async function D(n,t){const s=await R("api/auth/login",{username:n,password:t});if(!s.ok)return!1;const{token:o}=await s.json();return o?(localStorage.setItem("jwt",o),!0):!1}export{V as a,L as c,y as d,k as e,j as g,D as l,m,P as o,R as p,C as s};
