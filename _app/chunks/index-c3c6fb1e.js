import{e as d}from"./ws-9a419573.js";function h(o){var t={},e,r=0,n,a,s=0,i,c="",p=String.fromCharCode,l=o.length,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(e=0;e<64;e++)t[g.charAt(e)]=e;for(a=0;a<l;a++)for(n=t[o.charAt(a)],r=(r<<6)+n,s+=6;s>=8;)((i=r>>>(s-=8)&255)||a<l-2)&&(c+=p(i));return c}function S(o){if(!o)return{};const t=o.split(".")[1],e=t==null?void 0:t.replace(/-/g,"+").replace(/_/g,"/");if(!e)return{};const r=h(e);return JSON.parse(r)}const{VITE_API_URL:f=""}={VITE_API_URL:"https://si21.herokuapp.com",VITE_SVELTEKIT_AMP:"",BASE_URL:"/_app/",MODE:"production",DEV:!1,PROD:!0};async function u(o,{method:t,body:e,token:r}){const n={method:t};e&&(n.body=JSON.stringify(e));let a="localStorage"in globalThis?localStorage.getItem("jwt"):"";r&&(a=r),a&&(n.headers={Authentication:`Bearer ${r||a}`}),t==="POST"&&e&&("headers"in n||(n.headers={}),n.headers["Content-Type"]="application/json");const s=(f?f+"/":"/")+o;return console.groupCollapsed("send."+t.toLowerCase(),s),console.log({body:e,token:r,headers:n.headers}),console.groupEnd(),fetch(s,n)}function E(o,t){return u(o,{method:"GET",token:t})}function A(o){if("jwt"in localStorage){const{jwt:t}=localStorage,{role:e}=S(t);e==="ADMIN"&&(o.update(r=>(r.role=e,r)),d("admin",t))}}function T(o,t,e){return u(o,{method:"POST",body:t,token:e})}async function I(o,t){const e=await T("api/auth/login",{username:o,password:t});if(!e.ok)return!1;const{token:r}=await e.json();return r?(localStorage.setItem("jwt",r),!0):!1}export{S as d,E as g,I as l,T as p,A as s};
