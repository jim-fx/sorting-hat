var lt=Object.defineProperty,at=Object.defineProperties;var rt=Object.getOwnPropertyDescriptors;var Ee=Object.getOwnPropertySymbols;var ct=Object.prototype.hasOwnProperty,ut=Object.prototype.propertyIsEnumerable;var _e=(s,e,t)=>e in s?lt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,pe=(s,e)=>{for(var t in e||(e={}))ct.call(e,t)&&_e(s,t,e[t]);if(Ee)for(var t of Ee(e))ut.call(e,t)&&_e(s,t,e[t]);return s},Ae=(s,e)=>at(s,rt(e));var N=(s,e,t)=>(_e(s,typeof e!="symbol"?e+"":e,t),t);import{S as j,i as U,s as P,e as w,c as v,a as T,d as _,b,f as g,H as y,t as D,k as F,g as $,n as C,G as z,O as ze,P as O,Q as Te,h as me,R as ft,l as H,T as ht,x as k,u as L,A as ae,U as Q,V as re,W as Me,X as J,Y as ge,Z as ye,_ as dt,$ as X,a0 as we,j as Z,m as ce,F as ee,o as te,a1 as Re,v as ne,C as Se,a2 as _t,a3 as pt,a4 as mt,a5 as gt,a6 as yt,a7 as wt,a8 as vt,a9 as Ne,aa as bt,ab as ue,N as ve,ac as Ie,ad as Y,ae as Le,af as De,ag as kt,ah as xt,w as ie,ai as Et,r as se,aj as At,ak as zt}from"../chunks/vendor-ed08ca3a.js";import{g as Tt,p as Mt}from"../chunks/index-0f7edb9d.js";import{f as $e,u as G}from"../chunks/stores-f3c3934b.js";import{p as fe}from"../chunks/pointerStore-d4a3554d.js";/* empty css                                                      */import"../chunks/ws-9a419573.js";function Rt(s){let e,t,n,i,o,l,r,a,c,u,f;return{c(){e=w("p"),t=D("Ganzen Namen eingeben:"),n=F(),i=w("input"),o=F(),l=w("br"),r=F(),a=w("button"),c=D("fertig"),this.h()},l(h){e=v(h,"P",{});var d=T(e);t=$(d,"Ganzen Namen eingeben:"),d.forEach(_),n=C(h),i=v(h,"INPUT",{placeholder:!0,type:!0}),o=C(h),l=v(h,"BR",{}),r=C(h),a=v(h,"BUTTON",{});var p=T(a);c=$(p,"fertig"),p.forEach(_),this.h()},h(){b(i,"placeholder","Namen..."),b(i,"type","text")},m(h,d){g(h,e,d),z(e,t),g(h,n,d),g(h,i,d),ze(i,s[1]),g(h,o,d),g(h,l,d),g(h,r,d),g(h,a,d),z(a,c),u||(f=[O(i,"input",s[6]),O(i,"keydown",s[3]),O(a,"click",s[7])],u=!0)},p(h,d){d&2&&i.value!==h[1]&&ze(i,h[1])},d(h){h&&_(e),h&&_(n),h&&_(i),h&&_(o),h&&_(l),h&&_(r),h&&_(a),u=!1,Te(f)}}}function St(s){let e,t,n,i,o,l,r,a,c,u,f,h,d,p,m,A;return{c(){e=w("p"),t=D("Alles klar, "),n=w("b"),i=D(s[1]),o=D(", ist das der richtige Name?"),l=F(),r=w("br"),a=F(),c=w("div"),u=w("button"),f=D("Ja"),h=F(),d=w("button"),p=D("Nein")},l(x){e=v(x,"P",{});var E=T(e);t=$(E,"Alles klar, "),n=v(E,"B",{});var V=T(n);i=$(V,s[1]),V.forEach(_),o=$(E,", ist das der richtige Name?"),E.forEach(_),l=C(x),r=v(x,"BR",{}),a=C(x),c=v(x,"DIV",{});var R=T(c);u=v(R,"BUTTON",{});var S=T(u);f=$(S,"Ja"),S.forEach(_),h=C(R),d=v(R,"BUTTON",{});var q=T(d);p=$(q,"Nein"),q.forEach(_),R.forEach(_)},m(x,E){g(x,e,E),z(e,t),z(e,n),z(n,i),z(e,o),g(x,l,E),g(x,r,E),g(x,a,E),g(x,c,E),z(c,u),z(u,f),z(c,h),z(c,d),z(d,p),m||(A=[O(u,"click",s[4]),O(d,"click",s[5])],m=!0)},p(x,E){E&2&&me(i,x[1])},d(x){x&&_(e),x&&_(l),x&&_(r),x&&_(a),x&&_(c),m=!1,Te(A)}}}function Nt(s){let e;function t(o,l){return o[2]?St:Rt}let n=t(s),i=n(s);return{c(){e=w("div"),i.c(),this.h()},l(o){e=v(o,"DIV",{class:!0});var l=T(e);i.l(l),l.forEach(_),this.h()},h(){b(e,"class","wrapper svelte-1terpu9")},m(o,l){g(o,e,l),i.m(e,null)},p(o,[l]){n===(n=t(o))&&i?i.p(o,l):(i.d(1),i=n(o),i&&(i.c(),i.m(e,null)))},i:y,o:y,d(o){o&&_(e),i.d()}}}function It(s,e,t){let{callback:n}=e,i,o=!1;function l({key:f}){f==="Enter"&&t(2,o=!0)}const r=()=>n(i),a=()=>{t(2,o=!1)};function c(){i=this.value,t(1,i)}const u=()=>{t(2,o=!0)};return s.$$set=f=>{"callback"in f&&t(0,n=f.callback)},[n,i,o,l,r,a,c,u]}class Lt extends j{constructor(e){super();U(this,e,It,Nt,P,{callback:0})}}function Dt(s){return{c:y,l:y,m:y,p:y,i:y,o:y,d:y}}function $t(s){let e,t=s[6]+"",n,i,o,l,r,a,c,u,f,h,d;function p(){return s[3](s[6])}return{c(){e=w("h1"),n=D(t),i=F(),o=w("img"),a=F(),c=w("button"),u=D("Okay"),this.h()},l(m){e=v(m,"H1",{class:!0});var A=T(e);n=$(A,t),A.forEach(_),i=C(m),o=v(m,"IMG",{src:!0,alt:!0,class:!0}),a=C(m),c=v(m,"BUTTON",{});var x=T(c);u=$(x,"Okay"),x.forEach(_),this.h()},h(){b(e,"class","svelte-16th1rs"),Q(o.src,l="icons/"+s[6]+".svg")||b(o,"src",l),b(o,"alt","crest of house "+s[1]),b(o,"class","svelte-16th1rs")},m(m,A){g(m,e,A),z(e,n),g(m,i,A),g(m,o,A),g(m,a,A),g(m,c,A),z(c,u),f=!0,h||(d=O(c,"click",p),h=!0)},p(m,A){s=m},i(m){f||(re(()=>{r||(r=Me(o,J,{},!0)),r.run(1)}),f=!0)},o(m){r||(r=Me(o,J,{},!1)),r.run(0),f=!1},d(m){m&&_(e),m&&_(i),m&&_(o),m&&r&&r.end(),m&&_(a),m&&_(c),h=!1,d()}}}function Ft(s){return{c:y,l:y,m:y,p:y,i:y,o:y,d:y}}function Ct(s){let e,t,n={ctx:s,current:null,token:null,hasCatch:!1,pending:Ft,then:$t,catch:Dt,value:6,blocks:[,,,]};return ft(s[1],n),{c(){e=H(),n.block.c()},l(i){e=H(),n.block.l(i)},m(i,o){g(i,e,o),n.block.m(i,n.anchor=o),n.mount=()=>e.parentNode,n.anchor=e,t=!0},p(i,[o]){s=i,ht(n,s,o)},i(i){t||(k(n.block),t=!0)},o(i){for(let o=0;o<3;o+=1){const l=n.blocks[o];L(l)}t=!1},d(i){i&&_(e),n.block.d(i),n.token=null,n=null}}}function Ht(s,e,t){const n=!1,i=["ravenclaw","gryffindor","slytherin","hufflepuff"];async function o(){const c=await(await Tt("api/houses")).text();return c.length>20?i[Math.floor(Math.random()*i.length)]:c}let l=o(),{callback:r}=e;ae(async()=>{const c=await l,u=new Audio("audio/"+c+".mp3");u.play();const f=new Audio("audio/cheers.mp3"),h=setInterval(()=>{u.currentTime/u.duration>.2&&f.paused&&(f.play(),clearInterval(h))},50);u.addEventListener("progress",()=>{})});const a=c=>r(c);return s.$$set=c=>{"callback"in c&&t(0,r=c.callback)},[r,l,n,a]}class Bt extends j{constructor(e){super();U(this,e,Ht,Ct,P,{showText:2,callback:0})}get showText(){return this.$$.ctx[2]}}function Fe(s,e,t){const n=s.slice();return n[4]=e[t],n[6]=t,n}function Ce(s){let e,t,n,i,o,l;function r(){return s[3](s[4])}return{c(){e=w("img"),this.h()},l(a){e=v(a,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Q(e.src,t="icons/"+s[4]+".svg")||b(e,"src",t),b(e,"alt",n="crest of house "+s[4]),b(e,"class","svelte-16fuc7d")},m(a,c){g(a,e,c),o||(l=O(e,"click",r),o=!0)},p(a,c){s=a},i(a){i||re(()=>{i=ge(e,J,{delay:s[6]*200,duration:1200}),i.start()})},o:y,d(a){a&&_(e),o=!1,l()}}}function Ot(s){let e,t=s[0],n=[];for(let i=0;i<t.length;i+=1)n[i]=Ce(Fe(s,t,i));return{c(){e=w("div");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=v(i,"DIV",{class:!0});var o=T(e);for(let l=0;l<n.length;l+=1)n[l].l(o);o.forEach(_),this.h()},h(){b(e,"class","wrapper svelte-16fuc7d")},m(i,o){g(i,e,o);for(let l=0;l<n.length;l+=1)n[l].m(e,null)},p(i,[o]){if(o&3){t=i[0];let l;for(l=0;l<t.length;l+=1){const r=Fe(i,t,l);n[l]?(n[l].p(r,o),k(n[l],1)):(n[l]=Ce(r),n[l].c(),k(n[l],1),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},i(i){for(let o=0;o<t.length;o+=1)k(n[o])},o:y,d(i){i&&_(e),ye(n,i)}}}function Vt(s,e,t){let{callback:n}=e;const i=["ravenclaw","gryffindor","slytherin","hufflepuff"];function o(r){const a=new Audio("audio/"+r+".mp3");a.play(),a.addEventListener("ended",()=>{setTimeout(()=>{n(r)},200)})}const l=r=>o(r);return s.$$set=r=>{"callback"in r&&t(2,n=r.callback)},[i,o,n,l]}class jt extends j{constructor(e){super();U(this,e,Vt,Ot,P,{callback:2})}}function Ut(s){let e,t,n,i,o,l,r,a,c,u,f;function h(p){s[3](p)}let d={max:10,pips:!0,id:"range-slider",all:"label"};return s[1]!==void 0&&(d.values=s[1]),n=new dt({props:d}),X.push(()=>we(n,"values",h)),{c(){e=w("div"),t=w("div"),i=w("div"),Z(n.$$.fragment),l=F(),r=w("button"),a=D("Okay"),this.h()},l(p){e=v(p,"DIV",{class:!0});var m=T(e);t=v(m,"DIV",{class:!0});var A=T(t);i=v(A,"DIV",{style:!0});var x=T(i);ce(n.$$.fragment,x),A.forEach(_),l=C(m),r=v(m,"BUTTON",{});var E=T(r);a=$(E,"Okay"),E.forEach(_),m.forEach(_),this.h()},h(){ee(i,"display","contents"),ee(i,"--handle-focus","white"),ee(i,"--range-slider","black"),ee(i,"--range-handle","black"),ee(i,"--range-float-text","white"),b(t,"class","range-wrapper svelte-1ni4obk"),b(e,"class","wrapper svelte-1ni4obk")},m(p,m){g(p,e,m),z(e,t),z(t,i),te(n,i,null),z(e,l),z(e,r),z(r,a),c=!0,u||(f=O(r,"click",s[4]),u=!0)},p(p,[m]){const A={};!o&&m&2&&(o=!0,A.values=p[1],Re(()=>o=!1)),n.$set(A)},i(p){c||(k(n.$$.fragment,p),c=!0)},o(p){L(n.$$.fragment,p),c=!1},d(p){p&&_(e),ne(n),u=!1,f()}}}function Pt(s,e,t){let{callback:n}=e;const i=!0;let o=[5];function l(a){o=a,t(1,o)}const r=()=>n(o[0]);return s.$$set=a=>{"callback"in a&&t(0,n=a.callback)},[n,o,i,l,r]}class Gt extends j{constructor(e){super();U(this,e,Pt,Ut,P,{callback:0,showText:2})}get showText(){return this.$$.ctx[2]}}function qt(s){let e,t,n,i,o,l;return{c(){e=w("video"),t=w("source"),i=w("source"),l=w("track"),this.h()},l(r){e=v(r,"VIDEO",{width:!0,height:!0,class:!0});var a=T(e);t=v(a,"SOURCE",{src:!0,type:!0}),i=v(a,"SOURCE",{src:!0,type:!0}),l=v(a,"TRACK",{kind:!0}),a.forEach(_),this.h()},h(){Q(t.src,n=""+(s[0]+"video/video.webm"))||b(t,"src",n),b(t,"type","video/webm"),Q(i.src,o=""+(s[0]+"video/video.mp4"))||b(i,"src",o),b(i,"type","video/mp4"),b(l,"kind","captions"),b(e,"width","500"),b(e,"height","281"),e.controls=!0,e.autoplay=!0,b(e,"class","svelte-k2j555")},m(r,a){g(r,e,a),z(e,t),z(e,i),z(e,l)},p(r,[a]){a&1&&!Q(t.src,n=""+(r[0]+"video/video.webm"))&&b(t,"src",n),a&1&&!Q(i.src,o=""+(r[0]+"video/video.mp4"))&&b(i,"src",o)},i:y,o:y,d(r){r&&_(e)}}}function Wt(s,e,t){const n=!1;let i="";return ae(()=>{t(0,i=window.location.pathname)}),[i,n]}class Kt extends j{constructor(e){super();U(this,e,Wt,qt,P,{showText:1})}get showText(){return this.$$.ctx[1]}}const He=Se(),he=class{constructor({audioFile:e,element:t,text:n}){N(this,"audio");N(this,"text");N(this,"duration",5);N(this,"isLast",!0);N(this,"state",Se("suspended"));N(this,"nextActions",[]);N(this,"data");N(this,"element");N(this,"events",{});this.text=n,this.element=t,e&&(this.audio=new Audio("audio/"+e))}async start(){if(this.setActive(),await _t(),this.emit("start"),this.audio){this.duration=this.audio.duration,this.state.set("running"),this.audio.play(),he.anim.params.wiggleMouth=1;const e=setInterval(()=>{this.emit("progress",this.audio.currentTime/this.audio.duration)},200);this.audio.addEventListener("ended",()=>{clearInterval(e),setTimeout(()=>{this.speechEnded()},500)},{once:!0})}else this.duration=5,this.text&&(this.duration=Math.max(this.text.split(" ").length*.08,2),console.log(this.duration)),this.state.set("running"),setTimeout(()=>{this.speechEnded()},this.duration*1e3)}speechEnded(){this.emit("speech-ended"),he.anim.params.wiggleMouth=0,this.element?this.state.set("input"):this.finish()}handleElementCallback(e){console.log("Got Data: ",e),this.data=e,this.emit("data",e),this.finish()}finish(){this.state.set("finished"),this.emit("end"),console.log("Finished",this.nextActions),this.nextActions.length===1&&!("name"in this.nextActions[0])&&this.nextActions[0].action.start(),this.nextActions.length||$e.set(!0)}emit(e,t){e in this.events&&this.events[e].forEach(n=>n(t))}addEventListener(e,t){return this.events[e]=e in this.events?[...this.events[e],t]:[t],()=>{this.events[e]=this.events[e].filter(n=>n!==t)}}setActive(){He.set(this)}addAction(e,t){this.isLast=!1,typeof e!="string"?this.nextActions.push({action:e}):this.nextActions.push({name:e,action:t})}};let B=he;N(B,"anim");function Qt(s){B.anim=s;const e=new B({audioFile:"teilnehmen.mp3",text:"So so, du willst also an der Silvesterparty im Dungeon teilnehmen?"});e.addEventListener("start",()=>{s.params.wiggleMouth=1}),e.addEventListener("end",()=>{s.params.wiggleMouth=0,s.params.wiggleEyes=1});const t=new B({audioFile:"namen.mp3",text:"Sehr sch\xF6n, verstanden, jetzt br\xE4uchte ich noch deinen Namen?",element:Lt});t.addEventListener("data",f=>{console.log("Got Name",f),G.update(h=>(h.name=f,h))});const n=new B({audioFile:"unterhaltung.mp3",text:"Das ist nat\xFCrlich auch in Ordnung, damit du aber trotzdem nicht leer ausgehst habe ich hier etwas Unterhaltung f\xFCr dich:",element:Kt}),i=new B({audioFile:"exzellenter_gast.mp3",text:"Naja, okay, wenn das sooo ist? Dann werden wir mal schauen... Verstanden, du siehst wie ein exzellenter Gast aus."}),o=new B({audioFile:"welches_haus.mp3",text:"Weisst du den schon zu welchem der vier H\xE4user du geh\xF6rst?"});o.addEventListener("data",f=>{G.update(h=>(h.house=f,h))});const l=new B({audioFile:"random_haus.mp3",text:"Okay, um das herauszufinden bin ich ja hier. Dann werde ich mal  schauen, hmm, ich sehe Mut, aber auch Intelligenz, oh, und hier ist auch noch Empathie. Schwierige Entscheidung, aber ich denke:",element:Bt});l.addEventListener("start",()=>{s.params.wiggleMouth=1}),l.addEventListener("progress",f=>{f>.34&&(s.params.wiggleRim=2,s.params.wiggleHat=2,s.params.wiggleEyes=1)}),l.addEventListener("speech-ended",()=>{s.params.wiggleMouth=0,s.params.wiggleHat=.2,s.params.wiggleEyes=0,s.params.wiggleRim=.2}),l.addEventListener("data",f=>{G.update(h=>(h.house=f,h))});const r=new B({text:"W\xE4hle nun dein Haus aus:",element:jt});r.addEventListener("data",f=>{G.update(h=>(h.house=f,h))});const a=new B({audioFile:"sicherheit.mp3",text:"Nun zu letzten Frage, auf einer Skala von 0 bis 10, wie sicher k\xF6nnen wir mit deinem Erscheinen rechnen?",element:Gt});a.addEventListener("data",f=>{G.update(h=>(h.confidence=f/10,Mt("api",h),h))});const c=new B({audioFile:"final.mp3",text:"So, das war auch schon alles. Wir freuen uns, dich am 31.12 willkommen zu hei\xDFen, und w\xFCnschen dir bis dahin eine sch\xF6ne Weihnachtszeit."});e.addAction("Auf jeden Fall!",t),e.addAction("Ne, eher nicht",n),t.addAction(i),i.addAction(o),o.addAction("Aber nat\xFCrlich!",r),o.addAction("Nein, dass wei\xDF ich noch nicht...",l),l.addAction(a),r.addAction(a),a.addAction(c);const u=pt(G);return u.name&&u.house&&"confidence"in u?c:e}function Be(s,e=[]){return s.type==="Bone"&&!e.includes(s)&&e.push(s),s.children.forEach(t=>{t.type==="Bone"&&!e.includes(t)&&e.push(t),t.children.length&&Be(t,e)}),e}function I(s,e,t){return s*t+e*(1-t)}function Yt(s){const e={};return s.forEach(t=>{const{userData:{name:n}={}}=t;if(n){e[n]=t;const[i,o]=n.toLowerCase().split("_");o&&(e[i]=i in e?Ae(pe({},e[i]),{[o]:t}):{[o]:t},e[i+"Array"]=i+"Array"in e?[...e[i+"Array"],t]:[t])}}),e}function Jt(s){let e=!1;return{name:s.name,get dirty(){return e},clear:()=>{e=!1},rotation:{_x:0,ox:s.rotation.x,get x(){return this.ox+this._x},set x(t){t!==this._x&&(this._x=t,e=!0)},_y:0,oy:s.rotation.y,get y(){return this.oy+this._y},set y(t){t!==this._y&&(this._y=t,this._dirty=!0)},_z:0,oz:s.rotation.z,get z(){return this.oz+this._z},set z(t){t!==this._z&&(this._z=t,e=!0)}},position:{ox:s.position.x,_x:0,get x(){return this.ox+this._x},set x(t){t!==this._x&&(this._x=t,e=!0)},oy:s.position.y,_y:0,get y(){return this.oy+this._y},set y(t){t!==this._y&&(this._y=t,e=!0)},oz:s.position.z,_z:0,get z(){return this.oz+this._z},set z(t){t!==this._z&&(this._z=t,e=!0)}},scale:{ox:s.scale.x,_x:0,get x(){return this.ox+this._x},set x(t){t!==this._x&&(this._x=t,e=!0)},oy:s.scale.y,_y:0,get y(){return this.oy+this._y},set y(t){t!==this._y&&(this._y=t,e=!0)},oz:s.scale.z,_z:0,get z(){return this.oz+this._z},set z(t){t!==this._z&&(this._z=t,e=!0)}},id:s.uuid}}function be(s,e={bones:{}},t=0){if(s instanceof mt){if(s.uuid in e)return e[s.uuid];e.bones[s.uuid]=s;const o=Jt(s);return e[s.uuid]=o,o}if(Array.isArray(s))return s.map(o=>be(o,e,t+1));const n={},i=Object.keys(s);return i.length&&i.forEach(o=>{n[o]=be(s[o],e,t+1)}),t===0?{obj:n,cache:e}:n}function Xt(s){const{obj:e,cache:t}=be(s);return e._bones=t.bones,delete t.bones,e._all=Object.values(t),e}function Zt({_all:s,_bones:e}){s.forEach(t=>{if(!t.dirty)return;const n=e[t.id];!n||(n.rotation.x=I(t.rotation.x,n.rotation.x,.9),n.rotation.y=I(t.rotation.y,n.rotation.y,.9),n.rotation.z=I(t.rotation.z,n.rotation.z,.9),n.position.x=I(t.position.x,n.position.x,.9),n.position.y=I(t.position.y,n.position.y,.9),n.position.z=I(t.position.z,n.position.z,.9),n.scale.x=I(t.scale.x,n.scale.x,.9),n.scale.y=I(t.scale.y,n.scale.y,.9),n.scale.z=I(t.scale.z,n.scale.z,.9),t.clear())})}class en{constructor({scene:e,camera:t,renderer:n}){N(this,"boneArray",[]);N(this,"_bones",{circleArray:[],spineArray:[],mouthArray:[]});N(this,"bones",{});N(this,"loaded",!1);N(this,"controls");N(this,"conf",{wiggleRim:.05,wiggleHat:.05,wiggleMouth:.05,wiggleEyes:.05});N(this,"confKeys",[]);N(this,"params");this.controls=new gt(t,n.domElement),e.add(this.controls),this.params=pe({},this.conf),this.confKeys=Object.keys(this.conf),window.c=this.controls,this.setActiveBone=this.setActiveBone.bind(this)}setActiveBone(e){const t=this.boneArray.find(n=>n.userData.name===e);this.controls.attach(t)}setSkeleton(e){!e||(this.boneArray=Be(e),this._bones=Yt(this.boneArray),this.bones=Xt(this._bones),this.loaded=!!this.boneArray.length)}update(e){if(!this.loaded)return;const{bones:t,conf:n,confKeys:i,params:o}=this;if(i.forEach(l=>{o[l]!==n[l]&&(n[l]=I(o[l],n[l],.05))}),n.wiggleRim&&t.circleArray.forEach((l,r)=>{l.position.y=Math.sin(e/300+r*2)/100*n.wiggleRim}),n.wiggleHat&&t.spineArray.forEach((l,r)=>{l.rotation.x=Math.sin(e/300+r*2)/100*n.wiggleHat,l.rotation.y=Math.sin(e/300+r*1)/100*n.wiggleHat,l.rotation.z=Math.sin(e/300+r*0)/100*n.wiggleHat}),n.wiggleMouth&&(t.mouth.r1.scale.x=Math.sin(e/100+10)/10*n.wiggleMouth,t.mouth.l2.scale.x=Math.sin(e/100+5)/10*n.wiggleMouth,t.mouth.l1.scale.x=Math.sin(e/100+1)/4*n.wiggleMouth-.2,t.mouth.r2.scale.x=Math.sin(e/100+2)/4*n.wiggleMouth-.2,t.mouth.l1.position.y=Math.sin(e/100)/300*n.wiggleMouth-.01,t.mouth.r1.position.y=Math.sin(e/100)/300*n.wiggleMouth-.01),n.wiggleEyes){const l=e/400;t.eyes.l1.scale.x=Math.sin(l+1)/4*n.wiggleEyes-.2,t.eyes.r2.scale.x=Math.sin(l+2)/4*n.wiggleEyes-.2,t.eyes.l1.position.y=Math.sin(l)/300*n.wiggleEyes+.01,t.eyes.r1.position.y=Math.sin(e/200)/300*n.wiggleEyes+.01}Zt(this.bones)}}const Oe=new yt,tn=new wt,Ve=new vt;Ve.setDecoderPath("draco/");Oe.setDRACOLoader(Ve);function nn(s){return tn.load(s)}function je(s,e){return Oe.loadAsync(s,e)}async function sn(){const s=nn("textures/SortingHat_col.jpg");s.flipY=!1;const e=new Ne({map:s}),t=await je("sorting_hat.glb",i=>{console.log(i.loaded/i.total*100+"% loaded")}),n=t.scene.children[0].children[1];return n.material=e,t}function Ue(s){return new Promise((e,t)=>{const n=new Image;n.src=s,n.onerror=i=>t(i),n.onload=()=>e(n)})}async function on(s,e){const t=new FontFace(s,`url(${e})`);return await t.loaded,t}async function ln({name:s="",house:e=""}={}){console.log(s,e);const t=document.createElement("canvas");t.width=512,t.height=512;const n=t.getContext("2d"),i=new bt(t);i.flipY=!1;function o(){n.textAlign="center",n.font="10px Chantelli",n.fillText("Herzlich Willkommen",325,390),n.font="15px Chantelli bold",n.fillText(s,325,420),i.needsUpdate=!0}on("Chantelli","fonts/Chantelli_Antiqua-webfont.woff").then(()=>o()),Ue("textures/book_col.jpg").then(async c=>{n.drawImage(c,0,0,512,512),o();const u=await Ue(`icons/${e}.svg`);n.drawImage(u,270,240,120,120),o()});const l=new Ne({map:i}),r=await je("book.glb",c=>{console.log(c.loaded/c.total*100+"% loaded")}),a=r.scene.children[0].children[1];return a.material=l,r}var Pe={loadHat:sn,loadBook:ln};function an(s){let e,t;return{c(){e=w("canvas"),this.h()},l(n){e=v(n,"CANVAS",{style:!0,class:!0}),T(e).forEach(_),this.h()},h(){b(e,"style",t=`visibility:${s[1]!=="loading"?"visible":"hidden"}`),b(e,"class","svelte-rl5rk3"),ue(e,"loaded",s[1]!=="loading")},m(n,i){g(n,e,i),s[2](e)},p(n,[i]){i&2&&t!==(t=`visibility:${n[1]!=="loading"?"visible":"hidden"}`)&&b(e,"style",t),i&2&&ue(e,"loaded",n[1]!=="loading")},i:y,o:y,d(n){n&&_(e),s[2](null)}}}const ke=500;function Ge(s){return s<.5?16*s*s*s*s*s:1-Math.pow(-2*s+2,5)/2}function rn(s,e,t){let n;ve(s,G,E=>t(8,n=E));let i;const o=new Ie,l=new Y(12626431,.8);l.position.set(2.5,2.5,2),o.add(l);const r=new Y(16765393,.8);r.position.set(-2.5,2.5,2),o.add(r);const a=new Y(16777215,1);a.position.set(1,1,-1.5),o.add(a);const c=ke;let u=0,f=0,h="loading";const d=new Le(50,ke/c,.1,1e3);d.position.set(-.2,.8,-.1);const p={};async function m(){const E=await Pe.loadBook(n);E.scene.children[0].children[1].skeleton.bones.forEach(R=>{p[R.userData.name]=R}),p.Left.rotation.z=0,p.Left.position.x=-.02,p.Right.rotation.z=0,p.Right.position.x=.02,p.Root.rotation.z=-1.5-Math.PI*2,o.add(E.scene.children[0]),setTimeout(()=>{t(1,h="rotating")},500),window.skeleton=p}let A=0;ae(()=>{m();const E=new De({canvas:i,alpha:!0});E.setSize(ke,c);function V(S){switch(requestAnimationFrame(V),u=I(fe.x/-5,u,.1),f=I(fe.y/-5,f,.1)+.03,d.position.x=u,d.position.z=f,d.lookAt(0,0,0),h){case"rotating":A++;const q=Ge(A/120);p.Root.rotation.z=I(-1.5-Math.PI*2,0,1-q),A>120&&(A=0,t(1,h="opening"));break;case"opening":A++;const W=Ge(A/120);p.Left.rotation.z=I(1.67,0,W),p.Left.position.x=I(-.05,-.02,W),p.Right.rotation.z=I(-1.67,0,W),p.Right.position.x=I(.05,.02,W),A>120&&t(1,h="opened");break}R()}function R(){E.render(o,d)}V()});function x(E){X[E?"unshift":"push"](()=>{i=E,t(0,i)})}return[i,h,x]}class cn extends j{constructor(e){super();U(this,e,rn,an,P,{})}}function qe(s,e,t){const n=s.slice();return n[5]=e[t],n[7]=t,n}function We(s){let e,t=s[0],n=[];for(let i=0;i<t.length;i+=1)n[i]=Ke(qe(s,t,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=H()},l(i){for(let o=0;o<n.length;o+=1)n[o].l(i);e=H()},m(i,o){for(let l=0;l<n.length;l+=1)n[l].m(i,o);g(i,e,o)},p(i,o){if(o&1){t=i[0];let l;for(l=0;l<t.length;l+=1){const r=qe(i,t,l);n[l]?(n[l].p(r,o),k(n[l],1)):(n[l]=Ke(r),n[l].c(),k(n[l],1),n[l].m(e.parentNode,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},i(i){for(let o=0;o<t.length;o+=1)k(n[o])},o:y,d(i){ye(n,i),i&&_(e)}}}function Ke(s){let e,t=s[5]+"",n,i;return{c(){e=w("span"),n=D(t)},l(o){e=v(o,"SPAN",{});var l=T(e);n=$(l,t),l.forEach(_)},m(o,l){g(o,e,l),z(e,n)},p(o,l){s=o,l&1&&t!==(t=s[5]+"")&&me(n,t)},i(o){i||re(()=>{i=ge(e,kt,{duration:s[2],delay:s[7]*s[2]}),i.start()})},o:y,d(o){o&&_(e)}}}function un(s){let e,t=s[1]&&We(s);return{c(){e=w("div"),t&&t.c(),this.h()},l(n){e=v(n,"DIV",{class:!0});var i=T(e);t&&t.l(i),i.forEach(_),this.h()},h(){b(e,"class","wrapper svelte-zdezep")},m(n,i){g(n,e,i),t&&t.m(e,null)},p(n,[i]){n[1]?t?(t.p(n,i),i&2&&k(t,1)):(t=We(n),t.c(),k(t,1),t.m(e,null)):t&&(t.d(1),t=null)},i(n){k(t)},o:y,d(n){n&&_(e),t&&t.d()}}}function fn(s,e,t){let n,i,o,{text:l}=e,{duration:r}=e;return s.$$set=a=>{"text"in a&&t(3,l=a.text),"duration"in a&&t(4,r=a.duration)},s.$$.update=()=>{s.$$.dirty&8&&t(0,n=l.split(" ").map(a=>" "+a)),s.$$.dirty&17&&t(2,i=(r-.5)/n.length*1e3),s.$$.dirty&1&&t(1,o=!(n==null?void 0:n.length)),s.$$.dirty&1&&n.length&&setTimeout(()=>{t(1,o=!0)},200)},[n,o,i,l,r]}class hn extends j{constructor(e){super();U(this,e,fn,un,P,{text:3,duration:4})}}function Qe(s,e,t){const n=s.slice();return n[24]=e[t],n[26]=t,n}function dn(s){var h;let e,t,n,i,o,l,r,a,c,u=((h=s[1])==null?void 0:h.text)&&(s[8]==="running"||s[8]==="finished"||s[8]==="input")&&s[6]&&Ye(s),f=s[8]&&Je(s);return{c(){e=w("canvas"),i=F(),o=w("div"),u&&u.c(),l=F(),f&&f.c(),this.h()},l(d){e=v(d,"CANVAS",{style:!0,class:!0}),T(e).forEach(_),i=C(d),o=v(d,"DIV",{class:!0});var p=T(o);u&&u.l(p),l=C(p),f&&f.l(p),p.forEach(_),this.h()},h(){b(e,"style",t=`visibility:${s[3]?"visible":"hidden"}`),b(e,"class","svelte-1gtioab"),ue(e,"loaded",s[3]),b(o,"class","content svelte-1gtioab")},m(d,p){g(d,e,p),s[9](e),g(d,i,p),g(d,o,p),u&&u.m(o,null),z(o,l),f&&f.m(o,null),r=!0,a||(c=O(e,"click",s[10]),a=!0)},p(d,p){var m;(!r||p&8&&t!==(t=`visibility:${d[3]?"visible":"hidden"}`))&&b(e,"style",t),p&8&&ue(e,"loaded",d[3]),((m=d[1])==null?void 0:m.text)&&(d[8]==="running"||d[8]==="finished"||d[8]==="input")&&d[6]?u?(u.p(d,p),p&322&&k(u,1)):(u=Ye(d),u.c(),k(u,1),u.m(o,l)):u&&(se(),L(u,1,1,()=>{u=null}),ie()),d[8]?f?(f.p(d,p),p&256&&k(f,1)):(f=Je(d),f.c(),k(f,1),f.m(o,null)):f&&(se(),L(f,1,1,()=>{f=null}),ie())},i(d){r||(n&&n.end(1),k(u),k(f),r=!0)},o(d){n=At(e,J,{}),L(u),L(f),r=!1},d(d){d&&_(e),s[9](null),d&&n&&n.end(),d&&_(i),d&&_(o),u&&u.d(),f&&f.d(),a=!1,c()}}}function _n(s){let e,t;return e=new cn({}),{c(){Z(e.$$.fragment)},l(n){ce(e.$$.fragment,n)},m(n,i){te(e,n,i),t=!0},p:y,i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Ye(s){let e,t;return e=new hn({props:{text:s[1].text,duration:s[1].duration}}),{c(){Z(e.$$.fragment)},l(n){ce(e.$$.fragment,n)},m(n,i){te(e,n,i),t=!0},p(n,i){const o={};i&2&&(o.text=n[1].text),i&2&&(o.duration=n[1].duration),e.$set(o)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Je(s){let e,t,n,i;const o=[gn,mn,pn],l=[];function r(a,c){return a[8]==="suspended"?0:a[8]==="finished"?1:a[8]==="input"?2:-1}return~(e=r(s))&&(t=l[e]=o[e](s)),{c(){t&&t.c(),n=H()},l(a){t&&t.l(a),n=H()},m(a,c){~e&&l[e].m(a,c),g(a,n,c),i=!0},p(a,c){let u=e;e=r(a),e===u?~e&&l[e].p(a,c):(t&&(se(),L(l[u],1,1,()=>{l[u]=null}),ie()),~e?(t=l[e],t?t.p(a,c):(t=l[e]=o[e](a),t.c()),k(t,1),t.m(n.parentNode,n)):t=null)},i(a){i||(k(t),i=!0)},o(a){L(t),i=!1},d(a){~e&&l[e].d(a),a&&_(n)}}}function pn(s){let e,t,n,i;function o(a){s[14](a)}var l=s[1].element;function r(a){let c={callback:a[13]};return a[0]!==void 0&&(c.showText=a[0]),{props:c}}return l&&(e=new l(r(s)),X.push(()=>we(e,"showText",o))),{c(){e&&Z(e.$$.fragment),n=H()},l(a){e&&ce(e.$$.fragment,a),n=H()},m(a,c){e&&te(e,a,c),g(a,n,c),i=!0},p(a,c){const u={};if(c&2&&(u.callback=a[13]),!t&&c&1&&(t=!0,u.showText=a[0],Re(()=>t=!1)),l!==(l=a[1].element)){if(e){se();const f=e;L(f.$$.fragment,1,0,()=>{ne(f,1)}),ie()}l?(e=new l(r(a)),X.push(()=>we(e,"showText",o)),Z(e.$$.fragment),k(e.$$.fragment,1),te(e,n.parentNode,n)):e=null}else l&&e.$set(u)},i(a){i||(e&&k(e.$$.fragment,a),i=!0)},o(a){e&&L(e.$$.fragment,a),i=!1},d(a){a&&_(n),e&&ne(e,a)}}}function mn(s){var n,i;let e,t=((i=(n=s[1])==null?void 0:n.nextActions)==null?void 0:i.length)&&Xe(s);return{c(){t&&t.c(),e=H()},l(o){t&&t.l(o),e=H()},m(o,l){t&&t.m(o,l),g(o,e,l)},p(o,l){var r,a;((a=(r=o[1])==null?void 0:r.nextActions)==null?void 0:a.length)?t?(t.p(o,l),l&2&&k(t,1)):(t=Xe(o),t.c(),k(t,1),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i(o){k(t)},o:y,d(o){t&&t.d(o),o&&_(e)}}}function gn(s){let e,t,n,i;return{c(){e=w("button"),t=D("Starten")},l(o){e=v(o,"BUTTON",{});var l=T(e);t=$(l,"Starten"),l.forEach(_)},m(o,l){g(o,e,l),z(e,t),n||(i=O(e,"click",s[11]),n=!0)},p:y,i:y,o:y,d(o){o&&_(e),n=!1,i()}}}function Xe(s){let e,t=s[1].nextActions,n=[];for(let i=0;i<t.length;i+=1)n[i]=Ze(Qe(s,t,i));return{c(){e=w("div");for(let i=0;i<n.length;i+=1)n[i].c()},l(i){e=v(i,"DIV",{});var o=T(e);for(let l=0;l<n.length;l+=1)n[l].l(o);o.forEach(_)},m(i,o){g(i,e,o);for(let l=0;l<n.length;l+=1)n[l].m(e,null)},p(i,o){if(o&2){t=i[1].nextActions;let l;for(l=0;l<t.length;l+=1){const r=Qe(i,t,l);n[l]?(n[l].p(r,o),k(n[l],1)):(n[l]=Ze(r),n[l].c(),k(n[l],1),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},i(i){for(let o=0;o<t.length;o+=1)k(n[o])},o:y,d(i){i&&_(e),ye(n,i)}}}function Ze(s){let e,t=s[24].name+"",n,i,o,l;function r(){return s[12](s[24])}return{c(){e=w("button"),n=D(t)},l(a){e=v(a,"BUTTON",{});var c=T(e);n=$(c,t),c.forEach(_)},m(a,c){g(a,e,c),z(e,n),o||(l=O(e,"click",r),o=!0)},p(a,c){s=a,c&2&&t!==(t=s[24].name+"")&&me(n,t)},i(a){i||re(()=>{i=ge(e,J,{duration:200,delay:200*s[26]}),i.start()})},o:y,d(a){a&&_(e),o=!1,l()}}}function yn(s){let e,t,n,i,o;const l=[_n,dn],r=[];function a(c,u){return c[7]?0:1}return t=a(s),n=r[t]=l[t](s),{c(){e=F(),n.c(),i=H(),this.h()},l(c){xt('[data-svelte="svelte-tqpvny"]',document.head).forEach(_),e=C(c),n.l(c),i=H(),this.h()},h(){document.title="Dungeon Entry"},m(c,u){g(c,e,u),r[t].m(c,u),g(c,i,u),o=!0},p(c,[u]){let f=t;t=a(c),t===f?r[t].p(c,u):(se(),L(r[f],1,1,()=>{r[f]=null}),ie(),n=r[t],n?n.p(c,u):(n=r[t]=l[t](c),n.c()),k(n,1),n.m(i.parentNode,i))},i(c){o||(k(n),o=!0)},o(c){L(n),o=!1},d(c){c&&_(e),r[t].d(c),c&&_(i)}}}const xe=500;function wn(s,e,t){let n,i,o,l,r,a=y,c=()=>(a(),a=Et(i,M=>t(8,r=M)),i);ve(s,He,M=>t(1,o=M)),ve(s,$e,M=>t(7,l=M)),s.$$.on_destroy.push(()=>a());let u;const f=new Ie,h=new Y(12626431,.8);h.position.set(2.5,2.5,2),f.add(h);const d=new Y(16765393,.8);d.position.set(-2.5,2.5,2),f.add(d);const p=new Y(16777215,1);p.position.set(1,1,-1.5),f.add(p);let m=!0;const A=xe;let x=0,E=0,V=!1;const R=new Le(50,xe/A,.1,1e3);R.position.set(0,0,1);let S;async function q(){const M=await Pe.loadHat(),de=M.scene.children[0].children[1],oe=M.scene.children[0].children[0];S.setSkeleton(oe),de.geometry.computeBoundingBox();const K=new zt,le=de.geometry.boundingBox;le.getCenter(K),R.position.x=K.x,R.position.y=K.y;const ot=(le.max.y-K.y)*4/2/Math.tan(Math.PI*R.fov/360);R.position.z=ot,f.add(M.scene),t(3,V=!0)}ae(()=>{q();const M=new De({canvas:u,alpha:!0});M.setSize(xe,A),t(4,S=new en({scene:f,renderer:M,camera:R})),Qt(S).setActive();function oe(le){requestAnimationFrame(oe),S==null||S.update(le),x=I(fe.x,x,.1),E=I(fe.y,E,.1),R.position.x=x*-.8,R.position.y=E*.3+.1,R.lookAt(0,.2,0),K()}function K(){M.render(f,R)}oe(0)});function W(M){X[M?"unshift":"push"](()=>{u=M,t(2,u)})}const et=()=>{S.params.wiggleRim<1&&(t(4,S.params.wiggleRim=5,S),t(4,S.params.wiggleEyes=1,S),setTimeout(()=>{t(4,S.params.wiggleRim=0,S),t(4,S.params.wiggleEyes=0,S)},1e3))},tt=()=>o.start(),nt=M=>M.action.start(),it=M=>{o.handleElementCallback(M)};function st(M){m=M,t(0,m)}return s.$$.update=()=>{s.$$.dirty&1&&t(6,n=m===!0||m===void 0),s.$$.dirty&2&&c(t(5,i=o&&o.state))},[m,o,u,V,S,i,n,l,r,W,et,tt,nt,it,st]}class Mn extends j{constructor(e){super();U(this,e,wn,yn,P,{})}}export{Mn as default};
