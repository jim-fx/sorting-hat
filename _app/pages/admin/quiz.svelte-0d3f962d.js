import{S as R,i as I,s as X,e as T,t as z,k as S,c as q,a as y,g as D,d as h,n as U,b as A,f as $,G as d,h as j,H,Y as G,r as K,u as O,w as Y,x as B,al as ue,O as C,l as L,P as _e,j as F,m as J,o as W,v as Z,ab as x,A as he,am as de}from"../../chunks/vendor-4e2f73f3.js";import{g as pe,p as me,e as ve}from"../../chunks/index-21c51c30.js";import{T as ke}from"../../chunks/Crest.svelte_svelte_type_style_lang-238b461c.js";import{u as be,q as te}from"../../chunks/stores-182682cd.js";function le(o,e,l){const t=o.slice();return t[1]=e[l],t}function se(o){let e,l,t=o[1].name+"",s,a,f,i=o[1].house+"",n,r;return{c(){e=T("tr"),l=T("td"),s=z(t),a=S(),f=T("td"),n=z(i),r=S(),this.h()},l(c){e=q(c,"TR",{class:!0});var _=y(e);l=q(_,"TD",{class:!0});var u=y(l);s=D(u,t),u.forEach(h),a=U(_),f=q(_,"TD",{class:!0});var g=y(f);n=D(g,i),g.forEach(h),r=U(_),_.forEach(h),this.h()},h(){A(l,"class","svelte-g1t6o9"),A(f,"class","svelte-g1t6o9"),A(e,"class","svelte-g1t6o9")},m(c,_){$(c,e,_),d(e,l),d(l,s),d(e,a),d(e,f),d(f,n),d(e,r)},p(c,_){_&1&&t!==(t=c[1].name+"")&&j(s,t),_&1&&i!==(i=c[1].house+"")&&j(n,i)},d(c){c&&h(e)}}}function ge(o){let e,l,t,s,a,f,i,n,r,c,_=o[0].length+"",u,g,b=o[0],k=[];for(let v=0;v<b.length;v+=1)k[v]=se(le(o,b,v));return{c(){e=T("table"),l=T("thead"),t=T("td"),s=z("Name"),a=S(),f=T("td"),i=z("House"),n=S();for(let v=0;v<k.length;v+=1)k[v].c();r=S(),c=T("p"),u=z(_),g=z(" registrations"),this.h()},l(v){e=q(v,"TABLE",{class:!0});var w=y(e);l=q(w,"THEAD",{});var E=y(l);t=q(E,"TD",{class:!0});var Q=y(t);s=D(Q,"Name"),Q.forEach(h),a=U(E),f=q(E,"TD",{class:!0});var m=y(f);i=D(m,"House"),m.forEach(h),E.forEach(h),n=U(w);for(let p=0;p<k.length;p+=1)k[p].l(w);w.forEach(h),r=U(v),c=q(v,"P",{});var N=y(c);u=D(N,_),g=D(N," registrations"),N.forEach(h),this.h()},h(){A(t,"class","svelte-g1t6o9"),A(f,"class","svelte-g1t6o9"),A(e,"class","svelte-g1t6o9")},m(v,w){$(v,e,w),d(e,l),d(l,t),d(t,s),d(l,a),d(l,f),d(f,i),d(e,n);for(let E=0;E<k.length;E+=1)k[E].m(e,null);$(v,r,w),$(v,c,w),d(c,u),d(c,g)},p(v,[w]){if(w&1){b=v[0];let E;for(E=0;E<b.length;E+=1){const Q=le(v,b,E);k[E]?k[E].p(Q,w):(k[E]=se(Q),k[E].c(),k[E].m(e,null))}for(;E<k.length;E+=1)k[E].d(1);k.length=b.length}w&1&&_!==(_=v[0].length+"")&&j(u,_)},i:H,o:H,d(v){v&&h(e),G(k,v),v&&h(r),v&&h(c)}}}function we(o,e,l){let{users:t}=e;return o.$$set=s=>{"users"in s&&l(0,t=s.users)},[t]}class Ee extends R{constructor(e){super();I(this,e,we,ge,X,{users:0})}}function ne(o,e,l){const t=o.slice();return t[3]=e[l],t}function re(o,e,l){const t=o.slice();return t[6]=e[l],t}function ie(o,e,l){const t=o.slice();return t[9]=e[l],t}function oe(o){let e,l=o[9].value+"",t;return{c(){e=T("td"),t=z(l),this.h()},l(s){e=q(s,"TD",{class:!0});var a=y(e);t=D(a,l),a.forEach(h),this.h()},h(){A(e,"class","svelte-177xkck")},m(s,a){$(s,e,a),d(e,t)},p(s,a){a&2&&l!==(l=s[9].value+"")&&j(t,l)},d(s){s&&h(e)}}}function ae(o){let e,l=(o[6].votes.includes(o[3].id)?"X":" ")+"",t;return{c(){e=T("td"),t=z(l),this.h()},l(s){e=q(s,"TD",{class:!0});var a=y(e);t=D(a,l),a.forEach(h),this.h()},h(){A(e,"class","svelte-177xkck")},m(s,a){$(s,e,a),d(e,t)},p(s,a){a&3&&l!==(l=(s[6].votes.includes(s[3].id)?"X":" ")+"")&&j(t,l)},d(s){s&&h(e)}}}function ce(o){let e,l,t=o[3].name+"",s,a,f,i=o[1],n=[];for(let r=0;r<i.length;r+=1)n[r]=ae(re(o,i,r));return{c(){e=T("tr"),l=T("td"),s=z(t),a=S();for(let r=0;r<n.length;r+=1)n[r].c();f=S(),this.h()},l(r){e=q(r,"TR",{class:!0});var c=y(e);l=q(c,"TD",{class:!0});var _=y(l);s=D(_,t),_.forEach(h),a=U(c);for(let u=0;u<n.length;u+=1)n[u].l(c);f=U(c),c.forEach(h),this.h()},h(){A(l,"class","svelte-177xkck"),A(e,"class","svelte-177xkck")},m(r,c){$(r,e,c),d(e,l),d(l,s),d(e,a);for(let _=0;_<n.length;_+=1)n[_].m(e,null);d(e,f)},p(r,c){if(c&1&&t!==(t=r[3].name+"")&&j(s,t),c&3){i=r[1];let _;for(_=0;_<i.length;_+=1){const u=re(r,i,_);n[_]?n[_].p(u,c):(n[_]=ae(u),n[_].c(),n[_].m(e,f))}for(;_<n.length;_+=1)n[_].d(1);n.length=i.length}},d(r){r&&h(e),G(n,r)}}}function Te(o){let e,l,t,s,a,f,i,n,r,c=o[2].length+"",_,u,g=Math.floor(o[2].length/o[0].length*100)+"",b,k,v=o[1],w=[];for(let m=0;m<v.length;m+=1)w[m]=oe(ie(o,v,m));let E=o[0],Q=[];for(let m=0;m<E.length;m+=1)Q[m]=ce(ne(o,E,m));return{c(){e=T("div"),l=T("table"),t=T("thead"),s=T("td"),a=z("User"),f=S();for(let m=0;m<w.length;m+=1)w[m].c();i=S();for(let m=0;m<Q.length;m+=1)Q[m].c();n=S(),r=T("p"),_=z(c),u=z(" answers ("),b=z(g),k=z("%)"),this.h()},l(m){e=q(m,"DIV",{class:!0});var N=y(e);l=q(N,"TABLE",{class:!0});var p=y(l);t=q(p,"THEAD",{class:!0});var V=y(t);s=q(V,"TD",{class:!0});var ee=y(s);a=D(ee,"User"),ee.forEach(h),f=U(V);for(let P=0;P<w.length;P+=1)w[P].l(V);V.forEach(h),i=U(p);for(let P=0;P<Q.length;P+=1)Q[P].l(p);p.forEach(h),N.forEach(h),n=U(m),r=q(m,"P",{});var M=y(r);_=D(M,c),u=D(M," answers ("),b=D(M,g),k=D(M,"%)"),M.forEach(h),this.h()},h(){A(s,"class","svelte-177xkck"),A(t,"class","svelte-177xkck"),A(l,"class","svelte-177xkck"),A(e,"class","w-wrapper svelte-177xkck")},m(m,N){$(m,e,N),d(e,l),d(l,t),d(t,s),d(s,a),d(t,f);for(let p=0;p<w.length;p+=1)w[p].m(t,null);d(l,i);for(let p=0;p<Q.length;p+=1)Q[p].m(l,null);$(m,n,N),$(m,r,N),d(r,_),d(r,u),d(r,b),d(r,k)},p(m,[N]){if(N&2){v=m[1];let p;for(p=0;p<v.length;p+=1){const V=ie(m,v,p);w[p]?w[p].p(V,N):(w[p]=oe(V),w[p].c(),w[p].m(t,null))}for(;p<w.length;p+=1)w[p].d(1);w.length=v.length}if(N&3){E=m[0];let p;for(p=0;p<E.length;p+=1){const V=ne(m,E,p);Q[p]?Q[p].p(V,N):(Q[p]=ce(V),Q[p].c(),Q[p].m(l,null))}for(;p<Q.length;p+=1)Q[p].d(1);Q.length=E.length}N&1&&g!==(g=Math.floor(m[2].length/m[0].length*100)+"")&&j(b,g)},i:H,o:H,d(m){m&&h(e),G(w,m),G(Q,m),m&&h(n),m&&h(r)}}}function qe(o,e,l){let{users:t}=e,{answers:s}=e;const a=t.map(f=>{if(s.find(n=>n.votes.includes(f.id)))return{name:f.name,uid:f.id}}).filter(f=>!!f);return o.$$set=f=>{"users"in f&&l(0,t=f.users),"answers"in f&&l(1,s=f.answers)},[t,s,a]}class ye extends R{constructor(e){super();I(this,e,qe,Te,X,{users:0,answers:1})}}function $e(o){let e,l,t,s,a;function f(r,c){if(r[2]==="open")return Qe;if(r[2]==="voting-open")return Ae;if(r[2]==="closed")return De}let i=f(o),n=i&&i(o);return{c(){n&&n.c(),e=S(),l=T("button"),t=z("End Quiz"),this.h()},l(r){n&&n.l(r),e=U(r),l=q(r,"BUTTON",{class:!0});var c=y(l);t=D(c,"End Quiz"),c.forEach(h),this.h()},h(){A(l,"class","svelte-vf2kwq")},m(r,c){n&&n.m(r,c),$(r,e,c),$(r,l,c),d(l,t),s||(a=C(l,"click",o[10]),s=!0)},p(r,c){i===(i=f(r))&&n?n.p(r,c):(n&&n.d(1),n=i&&i(r),n&&(n.c(),n.m(e.parentNode,e)))},i:H,o:H,d(r){n&&n.d(r),r&&h(e),r&&h(l),s=!1,a()}}}function ze(o){let e,l,t,s;const a=[Se,Ne],f=[];function i(n,r){return n[0].startsAt?0:1}return e=i(o),l=f[e]=a[e](o),{c(){l.c(),t=L()},l(n){l.l(n),t=L()},m(n,r){f[e].m(n,r),$(n,t,r),s=!0},p(n,r){let c=e;e=i(n),e===c?f[e].p(n,r):(K(),O(f[c],1,1,()=>{f[c]=null}),Y(),l=f[e],l?l.p(n,r):(l=f[e]=a[e](n),l.c()),B(l,1),l.m(t.parentNode,t))},i(n){s||(B(l),s=!0)},o(n){O(l),s=!1},d(n){f[e].d(n),n&&h(t)}}}function De(o){let e,l,t,s;return{c(){e=T("button"),l=z("Next Question"),this.h()},l(a){e=q(a,"BUTTON",{class:!0});var f=y(e);l=D(f,"Next Question"),f.forEach(h),this.h()},h(){A(e,"class","svelte-vf2kwq")},m(a,f){$(a,e,f),d(e,l),t||(s=C(e,"click",o[9]),t=!0)},p:H,d(a){a&&h(e),t=!1,s()}}}function Ae(o){let e,l,t,s;return{c(){e=T("button"),l=z("Close Voting"),this.h()},l(a){e=q(a,"BUTTON",{class:!0});var f=y(e);l=D(f,"Close Voting"),f.forEach(h),this.h()},h(){A(e,"class","svelte-vf2kwq")},m(a,f){$(a,e,f),d(e,l),t||(s=C(e,"click",o[8]),t=!0)},p:H,d(a){a&&h(e),t=!1,s()}}}function Qe(o){var f;let e,l=(((f=o[1])==null?void 0:f.type)==="voting"?"Start Voting":"End Question")+"",t,s,a;return{c(){e=T("button"),t=z(l),this.h()},l(i){e=q(i,"BUTTON",{class:!0});var n=y(e);t=D(n,l),n.forEach(h),this.h()},h(){A(e,"class","svelte-vf2kwq")},m(i,n){$(i,e,n),d(e,t),s||(a=C(e,"click",o[7]),s=!0)},p(i,n){var r;n&2&&l!==(l=(((r=i[1])==null?void 0:r.type)==="voting"?"Start Voting":"End Question")+"")&&j(t,l)},d(i){i&&h(e),s=!1,a()}}}function Ne(o){let e,l,t,s,a,f,i;return{c(){e=T("button"),l=z("Start Quiz"),t=S(),s=T("button"),a=z("Start Quiz Timer"),this.h()},l(n){e=q(n,"BUTTON",{class:!0});var r=y(e);l=D(r,"Start Quiz"),r.forEach(h),t=U(n),s=q(n,"BUTTON",{class:!0});var c=y(s);a=D(c,"Start Quiz Timer"),c.forEach(h),this.h()},h(){A(e,"class","svelte-vf2kwq"),A(s,"class","svelte-vf2kwq")},m(n,r){$(n,e,r),d(e,l),$(n,t,r),$(n,s,r),d(s,a),f||(i=[C(e,"click",o[5]),C(s,"click",o[6])],f=!0)},p:H,i:H,o:H,d(n){n&&h(e),n&&h(t),n&&h(s),f=!1,_e(i)}}}function Se(o){let e,l;return e=new ke({props:{endsAt:o[0].startsAt}}),{c(){F(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,s){W(e,t,s),l=!0},p(t,s){const a={};s&1&&(a.endsAt=t[0].startsAt),e.$set(a)},i(t){l||(B(e.$$.fragment,t),l=!0)},o(t){O(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Ue(o){let e,l,t,s=(o[2]?"."+o[2]:"")+"",a,f,i,n,r,c;const _=[ze,$e],u=[];function g(b,k){return b[3]==="registration"?0:b[3]==="running"?1:-1}return~(n=g(o))&&(r=u[n]=_[n](o)),{c(){e=T("header"),l=T("h1"),t=z(o[3]),a=z(s),f=S(),i=T("div"),r&&r.c(),this.h()},l(b){e=q(b,"HEADER",{class:!0});var k=y(e);l=q(k,"H1",{class:!0});var v=y(l);t=D(v,o[3]),a=D(v,s),v.forEach(h),f=U(k),i=q(k,"DIV",{class:!0});var w=y(i);r&&r.l(w),w.forEach(h),k.forEach(h),this.h()},h(){A(l,"class","svelte-vf2kwq"),A(i,"class","scroller svelte-vf2kwq"),A(e,"class","svelte-vf2kwq")},m(b,k){$(b,e,k),d(e,l),d(l,t),d(l,a),d(e,f),d(e,i),~n&&u[n].m(i,null),c=!0},p(b,[k]){(!c||k&8)&&j(t,b[3]),(!c||k&4)&&s!==(s=(b[2]?"."+b[2]:"")+"")&&j(a,s);let v=n;n=g(b),n===v?~n&&u[n].p(b,k):(r&&(K(),O(u[v],1,1,()=>{u[v]=null}),Y()),~n?(r=u[n],r?r.p(b,k):(r=u[n]=_[n](b),r.c()),B(r,1),r.m(i,null)):r=null)},i(b){c||(B(r),c=!0)},o(b){O(r),c=!1},d(b){b&&h(e),~n&&u[n].d()}}}function He(o,e,l){let t,s,a;const f=ue();let{quiz:i}=e;const n=()=>{f("action","start-quiz")},r=()=>{f("action","start-quiz-timer")},c=()=>{f("action","close-question")},_=()=>{f("action","close-voting")},u=()=>{f("action","end-question")},g=()=>{confirm("End Quiz?")&&f("action","end-quiz")};return o.$$set=b=>{"quiz"in b&&l(0,i=b.quiz)},o.$$.update=()=>{o.$$.dirty&1&&l(1,t=i==null?void 0:i.activeQuestion),o.$$.dirty&1&&l(3,s=i==null?void 0:i.state),o.$$.dirty&2&&l(2,a=t==null?void 0:t.state)},[i,t,a,s,f,n,r,c,_,u,g]}class Be extends R{constructor(e){super();I(this,e,He,Ue,X,{quiz:0})}}const{window:Oe}=de;function je(o){let e,l;return{c(){e=T("p"),l=z("results")},l(t){e=q(t,"P",{});var s=y(e);l=D(s,"results"),s.forEach(h)},m(t,s){$(t,e,s),d(e,l)},p:H,i:H,o:H,d(t){t&&h(e)}}}function Ve(o){var n,r;let e,l=((n=o[1])==null?void 0:n.description)+"",t,s,a,f,i=((r=o[1])==null?void 0:r.answers)&&fe(o);return{c(){e=T("p"),t=z(l),s=S(),i&&i.c(),a=L()},l(c){e=q(c,"P",{});var _=y(e);t=D(_,l),_.forEach(h),s=U(c),i&&i.l(c),a=L()},m(c,_){$(c,e,_),d(e,t),$(c,s,_),i&&i.m(c,_),$(c,a,_),f=!0},p(c,_){var u,g;(!f||_&2)&&l!==(l=((u=c[1])==null?void 0:u.description)+"")&&j(t,l),((g=c[1])==null?void 0:g.answers)?i?(i.p(c,_),_&2&&B(i,1)):(i=fe(c),i.c(),B(i,1),i.m(a.parentNode,a)):i&&(K(),O(i,1,1,()=>{i=null}),Y())},i(c){f||(B(i),f=!0)},o(c){O(i),f=!1},d(c){c&&h(e),c&&h(s),i&&i.d(c),c&&h(a)}}}function Pe(o){let e,l;return e=new Ee({props:{users:o[0]}}),{c(){F(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,s){W(e,t,s),l=!0},p(t,s){const a={};s&1&&(a.users=t[0]),e.$set(a)},i(t){l||(B(e.$$.fragment,t),l=!0)},o(t){O(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function fe(o){let e,l;return e=new ye({props:{answers:o[1].answers,users:o[0]}}),{c(){F(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,s){W(e,t,s),l=!0},p(t,s){const a={};s&2&&(a.answers=t[1].answers),s&1&&(a.users=t[0]),e.$set(a)},i(t){l||(B(e.$$.fragment,t),l=!0)},o(t){O(e.$$.fragment,t),l=!1},d(t){Z(e,t)}}}function Ce(o){let e,l,t,s,a,f,i,n;e=new Be({props:{quiz:o[3]}}),e.$on("action",o[7]);const r=[Pe,Ve,je],c=[];function _(u,g){return u[2]==="registration"?0:u[2]==="running"?1:u[2]==="results"?2:-1}return~(t=_(o))&&(s=c[t]=r[t](o)),{c(){F(e.$$.fragment),l=S(),s&&s.c(),a=L()},l(u){J(e.$$.fragment,u),l=U(u),s&&s.l(u),a=L()},m(u,g){W(e,u,g),$(u,l,g),~t&&c[t].m(u,g),$(u,a,g),f=!0,i||(n=C(Oe,"keydown",o[4]),i=!0)},p(u,[g]){const b={};g&8&&(b.quiz=u[3]),e.$set(b);let k=t;t=_(u),t===k?~t&&c[t].p(u,g):(s&&(K(),O(c[k],1,1,()=>{c[k]=null}),Y()),~t?(s=c[t],s?s.p(u,g):(s=c[t]=r[t](u),s.c()),B(s,1),s.m(a.parentNode,a)):s=null)},i(u){f||(B(e.$$.fragment,u),B(s),f=!0)},o(u){O(e.$$.fragment,u),O(s),f=!1},d(u){Z(e,u),u&&h(l),~t&&c[t].d(u),u&&h(a),i=!1,n()}}}function Le(o,e,l){let t,s,a,f,i,n;x(o,be,u=>l(8,f=u)),x(o,te,u=>l(6,i=u)),x(o,te,u=>l(3,n=u));async function r({key:u}){if(u==="L"){const g=await pe("api/quiz");console.log(await g.json())}}function c(u){me("api/quiz",{action:u})}he(()=>{ve("quiz.admin",f)});const _=({detail:u})=>c(u);return o.$$.update=()=>{o.$$.dirty&64&&l(2,t=i==null?void 0:i.state),o.$$.dirty&64&&l(1,s=i==null?void 0:i.activeQuestion),o.$$.dirty&64&&l(0,a=i==null?void 0:i.users),o.$$.dirty&64&&i&&(window.quiz=i)},[a,s,t,n,r,c,i,_]}class Ge extends R{constructor(e){super();I(this,e,Le,Ce,X,{})}}export{Ge as default};
