var lt=Object.defineProperty;var ye=Object.getOwnPropertySymbols;var at=Object.prototype.hasOwnProperty,ot=Object.prototype.propertyIsEnumerable;var pe=(l,e,n)=>e in l?lt(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,Ee=(l,e)=>{for(var n in e||(e={}))at.call(e,n)&&pe(l,n,e[n]);if(ye)for(var n of ye(e))ot.call(e,n)&&pe(l,n,e[n]);return l};var R=(l,e,n)=>(pe(l,typeof e!="symbol"?e+"":e,n),n);import{S as U,i as q,s as P,e as v,c as w,a as x,d as _,b,f as g,H as k,t as N,k as F,g as L,n as H,G as M,M as Ae,N as B,O as Te,h as me,P as rt,l as C,Q as ct,x as E,u as D,A as oe,R as K,T as re,U as Me,V as J,W as ge,X as be,Y as ut,Z as X,_ as ve,j as Z,m as ce,F as ee,o as te,$ as xe,v as ne,C as ze,a0 as ft,a1 as dt,a2 as ht,a3 as _t,a4 as pt,a5 as mt,a6 as Se,a7 as gt,a8 as ue,a9 as fe,aa as Re,ab as Y,ac as Ie,ad as Ne,ae as bt,af as vt,w as ie,ag as wt,r as se,ah as kt,ai as yt}from"../chunks/vendor-3c54998b.js";import{g as Et,p as At}from"../chunks/index-76bbb2a0.js";import{f as Le,u as G,q as Tt}from"../chunks/stores-b0045d4a.js";import{f as Mt,b as xt,a as zt,l as V,c as St}from"../chunks/helpers-48d3bc19.js";import{p as de}from"../chunks/pointerStore-2d83d93d.js";/* empty css                                                      */function Rt(l){let e,n,t,i,s,a,r,o,u,h,d;return{c(){e=v("p"),n=N("Ganzen Namen eingeben:"),t=F(),i=v("input"),s=F(),a=v("br"),r=F(),o=v("button"),u=N("fertig"),this.h()},l(c){e=w(c,"P",{});var f=x(e);n=L(f,"Ganzen Namen eingeben:"),f.forEach(_),t=H(c),i=w(c,"INPUT",{placeholder:!0,type:!0}),s=H(c),a=w(c,"BR",{}),r=H(c),o=w(c,"BUTTON",{});var p=x(o);u=L(p,"fertig"),p.forEach(_),this.h()},h(){b(i,"placeholder","Namen..."),b(i,"type","text")},m(c,f){g(c,e,f),M(e,n),g(c,t,f),g(c,i,f),Ae(i,l[1]),g(c,s,f),g(c,a,f),g(c,r,f),g(c,o,f),M(o,u),h||(d=[B(i,"input",l[6]),B(i,"keydown",l[3]),B(o,"click",l[7])],h=!0)},p(c,f){f&2&&i.value!==c[1]&&Ae(i,c[1])},d(c){c&&_(e),c&&_(t),c&&_(i),c&&_(s),c&&_(a),c&&_(r),c&&_(o),h=!1,Te(d)}}}function It(l){let e,n,t,i,s,a,r,o,u,h,d,c,f,p,m,y;return{c(){e=v("p"),n=N("Alles klar, "),t=v("b"),i=N(l[1]),s=N(", ist das der richtige Name?"),a=F(),r=v("br"),o=F(),u=v("div"),h=v("button"),d=N("Ja"),c=F(),f=v("button"),p=N("Nein")},l(T){e=w(T,"P",{});var A=x(e);n=L(A,"Alles klar, "),t=w(A,"B",{});var j=x(t);i=L(j,l[1]),j.forEach(_),s=L(A,", ist das der richtige Name?"),A.forEach(_),a=H(T),r=w(T,"BR",{}),o=H(T),u=w(T,"DIV",{});var $=x(u);h=w($,"BUTTON",{});var I=x(h);d=L(I,"Ja"),I.forEach(_),c=H($),f=w($,"BUTTON",{});var S=x(f);p=L(S,"Nein"),S.forEach(_),$.forEach(_)},m(T,A){g(T,e,A),M(e,n),M(e,t),M(t,i),M(e,s),g(T,a,A),g(T,r,A),g(T,o,A),g(T,u,A),M(u,h),M(h,d),M(u,c),M(u,f),M(f,p),m||(y=[B(h,"click",l[4]),B(f,"click",l[5])],m=!0)},p(T,A){A&2&&me(i,T[1])},d(T){T&&_(e),T&&_(a),T&&_(r),T&&_(o),T&&_(u),m=!1,Te(y)}}}function Nt(l){let e;function n(s,a){return s[2]?It:Rt}let t=n(l),i=t(l);return{c(){e=v("div"),i.c(),this.h()},l(s){e=w(s,"DIV",{class:!0});var a=x(e);i.l(a),a.forEach(_),this.h()},h(){b(e,"class","wrapper svelte-1terpu9")},m(s,a){g(s,e,a),i.m(e,null)},p(s,[a]){t===(t=n(s))&&i?i.p(s,a):(i.d(1),i=t(s),i&&(i.c(),i.m(e,null)))},i:k,o:k,d(s){s&&_(e),i.d()}}}function Lt(l,e,n){let{callback:t}=e,i,s=!1;function a({key:d}){d==="Enter"&&n(2,s=!0)}const r=()=>t(i),o=()=>{n(2,s=!1)};function u(){i=this.value,n(1,i)}const h=()=>{n(2,s=!0)};return l.$$set=d=>{"callback"in d&&n(0,t=d.callback)},[t,i,s,a,r,o,u,h]}class Dt extends U{constructor(e){super();q(this,e,Lt,Nt,P,{callback:0})}}function Ft(l){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function Ht(l){let e,n=l[6]+"",t,i,s,a,r,o,u,h,d,c,f;function p(){return l[3](l[6])}return{c(){e=v("h1"),t=N(n),i=F(),s=v("img"),o=F(),u=v("button"),h=N("Okay"),this.h()},l(m){e=w(m,"H1",{class:!0});var y=x(e);t=L(y,n),y.forEach(_),i=H(m),s=w(m,"IMG",{src:!0,alt:!0,class:!0}),o=H(m),u=w(m,"BUTTON",{});var T=x(u);h=L(T,"Okay"),T.forEach(_),this.h()},h(){b(e,"class","svelte-16th1rs"),K(s.src,a="icons/"+l[6]+".svg")||b(s,"src",a),b(s,"alt","crest of house "+l[1]),b(s,"class","svelte-16th1rs")},m(m,y){g(m,e,y),M(e,t),g(m,i,y),g(m,s,y),g(m,o,y),g(m,u,y),M(u,h),d=!0,c||(f=B(u,"click",p),c=!0)},p(m,y){l=m},i(m){d||(re(()=>{r||(r=Me(s,J,{},!0)),r.run(1)}),d=!0)},o(m){r||(r=Me(s,J,{},!1)),r.run(0),d=!1},d(m){m&&_(e),m&&_(i),m&&_(s),m&&r&&r.end(),m&&_(o),m&&_(u),c=!1,f()}}}function $t(l){return{c:k,l:k,m:k,p:k,i:k,o:k,d:k}}function Ct(l){let e,n,t={ctx:l,current:null,token:null,hasCatch:!1,pending:$t,then:Ht,catch:Ft,value:6,blocks:[,,,]};return rt(l[1],t),{c(){e=C(),t.block.c()},l(i){e=C(),t.block.l(i)},m(i,s){g(i,e,s),t.block.m(i,t.anchor=s),t.mount=()=>e.parentNode,t.anchor=e,n=!0},p(i,[s]){l=i,ct(t,l,s)},i(i){n||(E(t.block),n=!0)},o(i){for(let s=0;s<3;s+=1){const a=t.blocks[s];D(a)}n=!1},d(i){i&&_(e),t.block.d(i),t.token=null,t=null}}}function Ot(l,e,n){const t=!1,i=["ravenclaw","gryffindor","slytherin","hufflepuff"];async function s(){const u=await(await Et("api/houses")).text();return u.length>20?i[Math.floor(Math.random()*i.length)]:u}let a=s(),{callback:r}=e;oe(async()=>{const u=await a,h=new Audio("audio/"+u+".mp3");h.play();const d=new Audio("audio/cheers.mp3"),c=setInterval(()=>{h.currentTime/h.duration>.2&&d.paused&&(d.play(),clearInterval(c))},50);h.addEventListener("progress",()=>{})});const o=u=>r(u);return l.$$set=u=>{"callback"in u&&n(0,r=u.callback)},[r,a,t,o]}class Bt extends U{constructor(e){super();q(this,e,Ot,Ct,P,{showText:2,callback:0})}get showText(){return this.$$.ctx[2]}}function De(l,e,n){const t=l.slice();return t[4]=e[n],t[6]=n,t}function Fe(l){let e,n,t,i,s,a;function r(){return l[3](l[4])}return{c(){e=v("img"),this.h()},l(o){e=w(o,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){K(e.src,n="icons/"+l[4]+".svg")||b(e,"src",n),b(e,"alt",t="crest of house "+l[4]),b(e,"class","svelte-16fuc7d")},m(o,u){g(o,e,u),s||(a=B(e,"click",r),s=!0)},p(o,u){l=o},i(o){i||re(()=>{i=ge(e,J,{delay:l[6]*200,duration:1200}),i.start()})},o:k,d(o){o&&_(e),s=!1,a()}}}function jt(l){let e,n=l[0],t=[];for(let i=0;i<n.length;i+=1)t[i]=Fe(De(l,n,i));return{c(){e=v("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=w(i,"DIV",{class:!0});var s=x(e);for(let a=0;a<t.length;a+=1)t[a].l(s);s.forEach(_),this.h()},h(){b(e,"class","wrapper svelte-16fuc7d")},m(i,s){g(i,e,s);for(let a=0;a<t.length;a+=1)t[a].m(e,null)},p(i,[s]){if(s&3){n=i[0];let a;for(a=0;a<n.length;a+=1){const r=De(i,n,a);t[a]?(t[a].p(r,s),E(t[a],1)):(t[a]=Fe(r),t[a].c(),E(t[a],1),t[a].m(e,null))}for(;a<t.length;a+=1)t[a].d(1);t.length=n.length}},i(i){for(let s=0;s<n.length;s+=1)E(t[s])},o:k,d(i){i&&_(e),be(t,i)}}}function Vt(l,e,n){let{callback:t}=e;const i=["ravenclaw","gryffindor","slytherin","hufflepuff"];function s(r){const o=new Audio("audio/"+r+".mp3");o.play(),o.addEventListener("ended",()=>{setTimeout(()=>{t(r)},200)})}const a=r=>s(r);return l.$$set=r=>{"callback"in r&&n(2,t=r.callback)},[i,s,t,a]}class Ut extends U{constructor(e){super();q(this,e,Vt,jt,P,{callback:2})}}function qt(l){let e,n,t,i,s,a,r,o,u,h,d;function c(p){l[3](p)}let f={max:10,pips:!0,id:"range-slider",all:"label"};return l[1]!==void 0&&(f.values=l[1]),t=new ut({props:f}),X.push(()=>ve(t,"values",c)),{c(){e=v("div"),n=v("div"),i=v("div"),Z(t.$$.fragment),a=F(),r=v("button"),o=N("Okay"),this.h()},l(p){e=w(p,"DIV",{class:!0});var m=x(e);n=w(m,"DIV",{class:!0});var y=x(n);i=w(y,"DIV",{style:!0});var T=x(i);ce(t.$$.fragment,T),y.forEach(_),a=H(m),r=w(m,"BUTTON",{});var A=x(r);o=L(A,"Okay"),A.forEach(_),m.forEach(_),this.h()},h(){ee(i,"display","contents"),ee(i,"--handle-focus","white"),ee(i,"--range-slider","black"),ee(i,"--range-handle","black"),ee(i,"--range-float-text","white"),b(n,"class","range-wrapper svelte-1ni4obk"),b(e,"class","wrapper svelte-1ni4obk")},m(p,m){g(p,e,m),M(e,n),M(n,i),te(t,i,null),M(e,a),M(e,r),M(r,o),u=!0,h||(d=B(r,"click",l[4]),h=!0)},p(p,[m]){const y={};!s&&m&2&&(s=!0,y.values=p[1],xe(()=>s=!1)),t.$set(y)},i(p){u||(E(t.$$.fragment,p),u=!0)},o(p){D(t.$$.fragment,p),u=!1},d(p){p&&_(e),ne(t),h=!1,d()}}}function Pt(l,e,n){let{callback:t}=e;const i=!0;let s=[5];function a(o){s=o,n(1,s)}const r=()=>t(s[0]);return l.$$set=o=>{"callback"in o&&n(0,t=o.callback)},[t,s,i,a,r]}class Gt extends U{constructor(e){super();q(this,e,Pt,qt,P,{callback:0,showText:2})}get showText(){return this.$$.ctx[2]}}function Wt(l){let e,n,t,i,s,a;return{c(){e=v("video"),n=v("source"),i=v("source"),a=v("track"),this.h()},l(r){e=w(r,"VIDEO",{width:!0,height:!0,class:!0});var o=x(e);n=w(o,"SOURCE",{src:!0,type:!0}),i=w(o,"SOURCE",{src:!0,type:!0}),a=w(o,"TRACK",{kind:!0}),o.forEach(_),this.h()},h(){K(n.src,t=""+(l[0]+"video/video.webm"))||b(n,"src",t),b(n,"type","video/webm"),K(i.src,s=""+(l[0]+"video/video.mp4"))||b(i,"src",s),b(i,"type","video/mp4"),b(a,"kind","captions"),b(e,"width","500"),b(e,"height","281"),e.controls=!0,e.autoplay=!0,b(e,"class","svelte-k2j555")},m(r,o){g(r,e,o),M(e,n),M(e,i),M(e,a)},p(r,[o]){o&1&&!K(n.src,t=""+(r[0]+"video/video.webm"))&&b(n,"src",t),o&1&&!K(i.src,s=""+(r[0]+"video/video.mp4"))&&b(i,"src",s)},i:k,o:k,d(r){r&&_(e)}}}function Qt(l,e,n){const t=!1;let i="";return oe(()=>{n(0,i=window.location.pathname)}),[i,t]}class Kt extends U{constructor(e){super();q(this,e,Qt,Wt,P,{showText:1})}get showText(){return this.$$.ctx[1]}}const He=ze(),he=class{constructor({audioFile:e,element:n,text:t}){R(this,"audio");R(this,"text");R(this,"duration",5);R(this,"isLast",!0);R(this,"state",ze("suspended"));R(this,"nextActions",[]);R(this,"data");R(this,"element");R(this,"events",{});this.text=t,this.element=n,e&&(this.audio=new Audio("audio/"+e))}async start(){if(this.setActive(),await ft(),this.emit("start"),this.audio){this.duration=this.audio.duration,this.state.set("running"),this.audio.play(),he.anim.params.wiggleMouth=1;const e=setInterval(()=>{this.emit("progress",this.audio.currentTime/this.audio.duration)},200);this.audio.addEventListener("ended",()=>{clearInterval(e),setTimeout(()=>{this.speechEnded()},500)},{once:!0})}else this.duration=5,this.text&&(this.duration=Math.max(this.text.split(" ").length*.08,2),console.log(this.duration)),this.state.set("running"),setTimeout(()=>{this.speechEnded()},this.duration*1e3)}speechEnded(){this.emit("speech-ended"),he.anim.params.wiggleMouth=0,this.element?this.state.set("input"):this.finish()}handleElementCallback(e){console.log("Got Data: ",e),this.data=e,this.emit("data",e),this.finish()}finish(){this.state.set("finished"),this.emit("end"),console.log("Finished",this.nextActions),this.nextActions.length===1&&!("name"in this.nextActions[0])&&this.nextActions[0].action.start(),this.nextActions.length||Le.set(!0)}emit(e,n){e in this.events&&this.events[e].forEach(t=>t(n))}addEventListener(e,n){return this.events[e]=e in this.events?[...this.events[e],n]:[n],()=>{this.events[e]=this.events[e].filter(t=>t!==n)}}setActive(){He.set(this)}addAction(e,n){this.isLast=!1,typeof e!="string"?this.nextActions.push({action:e}):this.nextActions.push({name:e,action:n})}};let O=he;R(O,"anim");function Yt(l){O.anim=l;const e=new O({audioFile:"teilnehmen.mp3",text:"So so, du willst also an der Silvesterparty im Dungeon teilnehmen?"});e.addEventListener("start",()=>{l.params.wiggleMouth=1}),e.addEventListener("end",()=>{l.params.wiggleMouth=0,l.params.wiggleEyes=1});const n=new O({audioFile:"namen.mp3",text:"Sehr sch\xF6n, verstanden, jetzt br\xE4uchte ich noch deinen Namen?",element:Dt});n.addEventListener("data",d=>{console.log("Got Name",d),G.update(c=>(c.name=d,c))});const t=new O({audioFile:"unterhaltung.mp3",text:"Das ist nat\xFCrlich auch in Ordnung, damit du aber trotzdem nicht leer ausgehst habe ich hier etwas Unterhaltung f\xFCr dich:",element:Kt}),i=new O({audioFile:"exzellenter_gast.mp3",text:"Naja, okay, wenn das sooo ist? Dann werden wir mal schauen... Verstanden, du siehst wie ein exzellenter Gast aus."}),s=new O({audioFile:"welches_haus.mp3",text:"Weisst du den schon zu welchem der vier H\xE4user du geh\xF6rst?"});s.addEventListener("data",d=>{G.update(c=>(c.house=d,c))});const a=new O({audioFile:"random_haus.mp3",text:"Okay, um das herauszufinden bin ich ja hier. Dann werde ich mal  schauen, hmm, ich sehe Mut, aber auch Intelligenz, oh, und hier ist auch noch Empathie. Schwierige Entscheidung, aber ich denke:",element:Bt});a.addEventListener("start",()=>{l.params.wiggleMouth=1}),a.addEventListener("progress",d=>{d>.34&&(l.params.wiggleRim=2,l.params.wiggleHat=2,l.params.wiggleEyes=1)}),a.addEventListener("speech-ended",()=>{l.params.wiggleMouth=0,l.params.wiggleHat=.2,l.params.wiggleEyes=0,l.params.wiggleRim=.2}),a.addEventListener("data",d=>{G.update(c=>(c.house=d,c))});const r=new O({text:"W\xE4hle nun dein Haus aus:",element:Ut});r.addEventListener("data",d=>{G.update(c=>(c.house=d,c))});const o=new O({audioFile:"sicherheit.mp3",text:"Nun zu letzten Frage, auf einer Skala von 0 bis 10, wie sicher k\xF6nnen wir mit deinem Erscheinen rechnen?",element:Gt});o.addEventListener("data",d=>{G.update(c=>(c.confidence=d/10,At("api",c),c))});const u=new O({audioFile:"final.mp3",text:"So, das war auch schon alles. Wir freuen uns, dich am 31.12 willkommen zu hei\xDFen, und w\xFCnschen dir bis dahin eine sch\xF6ne Weihnachtszeit."});e.addAction("Auf jeden Fall!",n),e.addAction("Ne, eher nicht",t),n.addAction(i),i.addAction(s),s.addAction("Aber nat\xFCrlich!",r),s.addAction("Nein, dass wei\xDF ich noch nicht...",a),a.addAction(o),r.addAction(o),o.addAction(u);const h=dt(G);return h.name&&h.house&&"confidence"in h?u:e}class Jt{constructor({scene:e,camera:n,renderer:t}){R(this,"boneArray",[]);R(this,"_bones",{circleArray:[],spineArray:[],mouthArray:[]});R(this,"bones",{});R(this,"loaded",!1);R(this,"controls");R(this,"conf",{wiggleRim:.05,wiggleHat:.05,wiggleMouth:.05,wiggleEyes:.05});R(this,"confKeys",[]);R(this,"params");this.controls=new ht(n,t.domElement),e.add(this.controls),this.params=Ee({},this.conf),this.confKeys=Object.keys(this.conf),window.c=this.controls,this.setActiveBone=this.setActiveBone.bind(this)}setActiveBone(e){const n=this.boneArray.find(t=>t.userData.name===e);this.controls.attach(n)}setSkeleton(e){!e||(this.boneArray=Mt(e),this._bones=xt(this.boneArray),this.bones=zt(this._bones),this.loaded=!!this.boneArray.length)}update(e){if(!this.loaded)return;const{bones:n,conf:t,confKeys:i,params:s}=this;if(i.forEach(a=>{s[a]!==t[a]&&(t[a]=V(s[a],t[a],.05))}),t.wiggleRim&&n.circleArray.forEach((a,r)=>{a.position.y=Math.sin(e/300+r*2)/100*t.wiggleRim}),t.wiggleHat&&n.spineArray.forEach((a,r)=>{a.rotation.x=Math.sin(e/300+r*2)/100*t.wiggleHat,a.rotation.y=Math.sin(e/300+r*1)/100*t.wiggleHat,a.rotation.z=Math.sin(e/300+r*0)/100*t.wiggleHat}),t.wiggleMouth&&(n.mouth.r1.scale.x=Math.sin(e/100+10)/10*t.wiggleMouth,n.mouth.l2.scale.x=Math.sin(e/100+5)/10*t.wiggleMouth,n.mouth.l1.scale.x=Math.sin(e/100+1)/4*t.wiggleMouth-.2,n.mouth.r2.scale.x=Math.sin(e/100+2)/4*t.wiggleMouth-.2,n.mouth.l1.position.y=Math.sin(e/100)/300*t.wiggleMouth-.01,n.mouth.r1.position.y=Math.sin(e/100)/300*t.wiggleMouth-.01),t.wiggleEyes){const a=e/400;n.eyes.l1.scale.x=Math.sin(a+1)/4*t.wiggleEyes-.2,n.eyes.r2.scale.x=Math.sin(a+2)/4*t.wiggleEyes-.2,n.eyes.l1.position.y=Math.sin(a)/300*t.wiggleEyes+.01,n.eyes.r1.position.y=Math.sin(e/200)/300*t.wiggleEyes+.01}St(this.bones)}}const $e=new _t,Xt=new pt,Ce=new mt;Ce.setDecoderPath("draco/");$e.setDRACOLoader(Ce);function Zt(l){return Xt.load(l)}function Oe(l,e){return $e.loadAsync(l,e)}async function en(){const l=Zt("textures/SortingHat_col.jpg");l.flipY=!1;const e=new Se({map:l}),n=await Oe("sorting_hat.glb",i=>{console.log(i.loaded/i.total*100+"% loaded")}),t=n.scene.children[0].children[1];return t.material=e,n}function Be(l){return new Promise((e,n)=>{const t=new Image;t.src=l,t.onerror=i=>n(i),t.onload=()=>e(t)})}async function tn(l,e){const n=new FontFace(l,`url(${e})`);return await n.loaded,n}async function nn({name:l="",house:e=""}={}){const n=document.createElement("canvas");n.width=512,n.height=512;const t=n.getContext("2d"),i=new gt(n);i.flipY=!1;function s(){t.textAlign="center",t.font="10px Chantelli",t.fillText("Herzlich Willkommen",325,390),t.font="15px Chantelli bold",t.fillText(l,325,420),i.needsUpdate=!0}tn("Chantelli","fonts/Chantelli_Antiqua-webfont.woff").then(()=>s()),Be("textures/book_col.jpg").then(async u=>{t.drawImage(u,0,0,512,512),s();const h=await Be(`icons/${e}.svg`);t.drawImage(h,270,240,120,120),s()});const a=new Se({map:i}),r=await Oe("book.glb",u=>{console.log(u.loaded/u.total*100+"% loaded")}),o=r.scene.children[0].children[1];return o.material=a,r}var je={loadHat:en,loadBook:nn};function sn(l){let e,n;return{c(){e=v("canvas"),this.h()},l(t){e=w(t,"CANVAS",{style:!0,class:!0}),x(e).forEach(_),this.h()},h(){b(e,"style",n=`visibility:${l[1]!=="loading"?"visible":"hidden"}`),b(e,"class","svelte-rl5rk3"),ue(e,"loaded",l[1]!=="loading")},m(t,i){g(t,e,i),l[2](e)},p(t,[i]){i&2&&n!==(n=`visibility:${t[1]!=="loading"?"visible":"hidden"}`)&&b(e,"style",n),i&2&&ue(e,"loaded",t[1]!=="loading")},i:k,o:k,d(t){t&&_(e),l[2](null)}}}const we=500;function Ve(l){return l<.5?16*l*l*l*l*l:1-Math.pow(-2*l+2,5)/2}function ln(l,e,n){let t;fe(l,G,A=>n(8,t=A));let i;const s=new Re,a=new Y(12626431,.8);a.position.set(2.5,2.5,2),s.add(a);const r=new Y(16765393,.8);r.position.set(-2.5,2.5,2),s.add(r);const o=new Y(16777215,1);o.position.set(1,1,-1.5),s.add(o);const u=we;let h=0,d=0,c="loading";const f=new Ie(50,we/u,.1,1e3);f.position.set(-.2,.8,-.1);const p={};async function m(){const A=await je.loadBook(t);A.scene.children[0].children[1].skeleton.bones.forEach($=>{p[$.userData.name]=$}),p.Left.rotation.z=0,p.Left.position.x=-.02,p.Right.rotation.z=0,p.Right.position.x=.02,p.Root.rotation.z=-1.5-Math.PI*2,s.add(A.scene.children[0]),setTimeout(()=>{n(1,c="rotating")},500),window.skeleton=p}let y=0;oe(()=>{m();const A=new Ne({canvas:i,alpha:!0});A.setSize(we,u);function j(I){switch(requestAnimationFrame(j),h=V(de.x/-5,h,.1),d=V(de.y/-5,d,.1)+.03,f.position.x=h,f.position.z=d,f.lookAt(0,0,0),c){case"rotating":y++;const S=Ve(y/120);p.Root.rotation.z=V(-1.5-Math.PI*2,0,1-S),y>120&&(y=0,n(1,c="opening"));break;case"opening":y++;const W=Ve(y/120);p.Left.rotation.z=V(1.67,0,W),p.Left.position.x=V(-.05,-.02,W),p.Right.rotation.z=V(-1.67,0,W),p.Right.position.x=V(.05,.02,W),y>120&&n(1,c="opened");break}$()}function $(){A.render(s,f)}j()});function T(A){X[A?"unshift":"push"](()=>{i=A,n(0,i)})}return[i,c,T]}class an extends U{constructor(e){super();q(this,e,ln,sn,P,{})}}function Ue(l,e,n){const t=l.slice();return t[5]=e[n],t[7]=n,t}function qe(l){let e,n=l[0],t=[];for(let i=0;i<n.length;i+=1)t[i]=Pe(Ue(l,n,i));return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=C()},l(i){for(let s=0;s<t.length;s+=1)t[s].l(i);e=C()},m(i,s){for(let a=0;a<t.length;a+=1)t[a].m(i,s);g(i,e,s)},p(i,s){if(s&1){n=i[0];let a;for(a=0;a<n.length;a+=1){const r=Ue(i,n,a);t[a]?(t[a].p(r,s),E(t[a],1)):(t[a]=Pe(r),t[a].c(),E(t[a],1),t[a].m(e.parentNode,e))}for(;a<t.length;a+=1)t[a].d(1);t.length=n.length}},i(i){for(let s=0;s<n.length;s+=1)E(t[s])},o:k,d(i){be(t,i),i&&_(e)}}}function Pe(l){let e,n=l[5]+"",t,i;return{c(){e=v("span"),t=N(n)},l(s){e=w(s,"SPAN",{});var a=x(e);t=L(a,n),a.forEach(_)},m(s,a){g(s,e,a),M(e,t)},p(s,a){l=s,a&1&&n!==(n=l[5]+"")&&me(t,n)},i(s){i||re(()=>{i=ge(e,bt,{duration:l[2],delay:l[7]*l[2]}),i.start()})},o:k,d(s){s&&_(e)}}}function on(l){let e,n=l[1]&&qe(l);return{c(){e=v("div"),n&&n.c(),this.h()},l(t){e=w(t,"DIV",{class:!0});var i=x(e);n&&n.l(i),i.forEach(_),this.h()},h(){b(e,"class","wrapper svelte-zdezep")},m(t,i){g(t,e,i),n&&n.m(e,null)},p(t,[i]){t[1]?n?(n.p(t,i),i&2&&E(n,1)):(n=qe(t),n.c(),E(n,1),n.m(e,null)):n&&(n.d(1),n=null)},i(t){E(n)},o:k,d(t){t&&_(e),n&&n.d()}}}function rn(l,e,n){let t,i,s,{text:a}=e,{duration:r}=e;return l.$$set=o=>{"text"in o&&n(3,a=o.text),"duration"in o&&n(4,r=o.duration)},l.$$.update=()=>{l.$$.dirty&8&&n(0,t=a.split(" ").map(o=>" "+o)),l.$$.dirty&17&&n(2,i=(r-.5)/t.length*1e3),l.$$.dirty&1&&n(1,s=!(t==null?void 0:t.length)),l.$$.dirty&1&&t.length&&setTimeout(()=>{n(1,s=!0)},200)},[t,s,i,a,r]}class cn extends U{constructor(e){super();q(this,e,rn,on,P,{text:3,duration:4})}}function Ge(l,e,n){const t=l.slice();return t[25]=e[n],t[27]=n,t}function We(l){let e,n;return{c(){e=v("a"),n=N("Enter Quiz"),this.h()},l(t){e=w(t,"A",{id:!0,href:!0,class:!0});var i=x(e);n=L(i,"Enter Quiz"),i.forEach(_),this.h()},h(){b(e,"id","enter-quiz"),b(e,"href","/quiz"),b(e,"class","svelte-xzkll9")},m(t,i){g(t,e,i),M(e,n)},d(t){t&&_(e)}}}function un(l){var c;let e,n,t,i,s,a,r,o,u,h=((c=l[1])==null?void 0:c.text)&&(l[9]==="running"||l[9]==="finished"||l[9]==="input")&&l[6]&&Qe(l),d=l[9]&&Ke(l);return{c(){e=v("canvas"),i=F(),s=v("div"),h&&h.c(),a=F(),d&&d.c(),this.h()},l(f){e=w(f,"CANVAS",{style:!0,class:!0}),x(e).forEach(_),i=H(f),s=w(f,"DIV",{class:!0});var p=x(s);h&&h.l(p),a=H(p),d&&d.l(p),p.forEach(_),this.h()},h(){b(e,"style",n=`visibility:${l[3]?"visible":"hidden"}`),b(e,"class","svelte-xzkll9"),ue(e,"loaded",l[3]),b(s,"class","content svelte-xzkll9")},m(f,p){g(f,e,p),l[10](e),g(f,i,p),g(f,s,p),h&&h.m(s,null),M(s,a),d&&d.m(s,null),r=!0,o||(u=B(e,"click",l[11]),o=!0)},p(f,p){var m;(!r||p&8&&n!==(n=`visibility:${f[3]?"visible":"hidden"}`))&&b(e,"style",n),p&8&&ue(e,"loaded",f[3]),((m=f[1])==null?void 0:m.text)&&(f[9]==="running"||f[9]==="finished"||f[9]==="input")&&f[6]?h?(h.p(f,p),p&578&&E(h,1)):(h=Qe(f),h.c(),E(h,1),h.m(s,a)):h&&(se(),D(h,1,1,()=>{h=null}),ie()),f[9]?d?(d.p(f,p),p&512&&E(d,1)):(d=Ke(f),d.c(),E(d,1),d.m(s,null)):d&&(se(),D(d,1,1,()=>{d=null}),ie())},i(f){r||(t&&t.end(1),E(h),E(d),r=!0)},o(f){t=kt(e,J,{}),D(h),D(d),r=!1},d(f){f&&_(e),l[10](null),f&&t&&t.end(),f&&_(i),f&&_(s),h&&h.d(),d&&d.d(),o=!1,u()}}}function fn(l){let e,n;return e=new an({}),{c(){Z(e.$$.fragment)},l(t){ce(e.$$.fragment,t)},m(t,i){te(e,t,i),n=!0},p:k,i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function Qe(l){let e,n;return e=new cn({props:{text:l[1].text,duration:l[1].duration}}),{c(){Z(e.$$.fragment)},l(t){ce(e.$$.fragment,t)},m(t,i){te(e,t,i),n=!0},p(t,i){const s={};i&2&&(s.text=t[1].text),i&2&&(s.duration=t[1].duration),e.$set(s)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){D(e.$$.fragment,t),n=!1},d(t){ne(e,t)}}}function Ke(l){let e,n,t,i;const s=[_n,hn,dn],a=[];function r(o,u){return o[9]==="suspended"?0:o[9]==="finished"?1:o[9]==="input"?2:-1}return~(e=r(l))&&(n=a[e]=s[e](l)),{c(){n&&n.c(),t=C()},l(o){n&&n.l(o),t=C()},m(o,u){~e&&a[e].m(o,u),g(o,t,u),i=!0},p(o,u){let h=e;e=r(o),e===h?~e&&a[e].p(o,u):(n&&(se(),D(a[h],1,1,()=>{a[h]=null}),ie()),~e?(n=a[e],n?n.p(o,u):(n=a[e]=s[e](o),n.c()),E(n,1),n.m(t.parentNode,t)):n=null)},i(o){i||(E(n),i=!0)},o(o){D(n),i=!1},d(o){~e&&a[e].d(o),o&&_(t)}}}function dn(l){let e,n,t,i;function s(o){l[15](o)}var a=l[1].element;function r(o){let u={callback:o[14]};return o[0]!==void 0&&(u.showText=o[0]),{props:u}}return a&&(e=new a(r(l)),X.push(()=>ve(e,"showText",s))),{c(){e&&Z(e.$$.fragment),t=C()},l(o){e&&ce(e.$$.fragment,o),t=C()},m(o,u){e&&te(e,o,u),g(o,t,u),i=!0},p(o,u){const h={};if(u&2&&(h.callback=o[14]),!n&&u&1&&(n=!0,h.showText=o[0],xe(()=>n=!1)),a!==(a=o[1].element)){if(e){se();const d=e;D(d.$$.fragment,1,0,()=>{ne(d,1)}),ie()}a?(e=new a(r(o)),X.push(()=>ve(e,"showText",s)),Z(e.$$.fragment),E(e.$$.fragment,1),te(e,t.parentNode,t)):e=null}else a&&e.$set(h)},i(o){i||(e&&E(e.$$.fragment,o),i=!0)},o(o){e&&D(e.$$.fragment,o),i=!1},d(o){o&&_(t),e&&ne(e,o)}}}function hn(l){var t,i;let e,n=((i=(t=l[1])==null?void 0:t.nextActions)==null?void 0:i.length)&&Ye(l);return{c(){n&&n.c(),e=C()},l(s){n&&n.l(s),e=C()},m(s,a){n&&n.m(s,a),g(s,e,a)},p(s,a){var r,o;((o=(r=s[1])==null?void 0:r.nextActions)==null?void 0:o.length)?n?(n.p(s,a),a&2&&E(n,1)):(n=Ye(s),n.c(),E(n,1),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i(s){E(n)},o:k,d(s){n&&n.d(s),s&&_(e)}}}function _n(l){let e,n,t,i;return{c(){e=v("button"),n=N("Starten")},l(s){e=w(s,"BUTTON",{});var a=x(e);n=L(a,"Starten"),a.forEach(_)},m(s,a){g(s,e,a),M(e,n),t||(i=B(e,"click",l[12]),t=!0)},p:k,i:k,o:k,d(s){s&&_(e),t=!1,i()}}}function Ye(l){let e,n=l[1].nextActions,t=[];for(let i=0;i<n.length;i+=1)t[i]=Je(Ge(l,n,i));return{c(){e=v("div");for(let i=0;i<t.length;i+=1)t[i].c()},l(i){e=w(i,"DIV",{});var s=x(e);for(let a=0;a<t.length;a+=1)t[a].l(s);s.forEach(_)},m(i,s){g(i,e,s);for(let a=0;a<t.length;a+=1)t[a].m(e,null)},p(i,s){if(s&2){n=i[1].nextActions;let a;for(a=0;a<n.length;a+=1){const r=Ge(i,n,a);t[a]?(t[a].p(r,s),E(t[a],1)):(t[a]=Je(r),t[a].c(),E(t[a],1),t[a].m(e,null))}for(;a<t.length;a+=1)t[a].d(1);t.length=n.length}},i(i){for(let s=0;s<n.length;s+=1)E(t[s])},o:k,d(i){i&&_(e),be(t,i)}}}function Je(l){let e,n=l[25].name+"",t,i,s,a;function r(){return l[13](l[25])}return{c(){e=v("button"),t=N(n)},l(o){e=w(o,"BUTTON",{});var u=x(e);t=L(u,n),u.forEach(_)},m(o,u){g(o,e,u),M(e,t),s||(a=B(e,"click",r),s=!0)},p(o,u){l=o,u&2&&n!==(n=l[25].name+"")&&me(t,n)},i(o){i||re(()=>{i=ge(e,J,{duration:200,delay:200*l[27]}),i.start()})},o:k,d(o){o&&_(e),s=!1,a()}}}function pn(l){var d;let e,n,t,i,s,a,r=((d=l[7])==null?void 0:d.state)==="registration"&&We();const o=[fn,un],u=[];function h(c,f){return c[8]?0:1}return t=h(l),i=u[t]=o[t](l),{c(){e=F(),r&&r.c(),n=F(),i.c(),s=C(),this.h()},l(c){vt('[data-svelte="svelte-tqpvny"]',document.head).forEach(_),e=H(c),r&&r.l(c),n=H(c),i.l(c),s=C(),this.h()},h(){document.title="Dungeon Entry"},m(c,f){g(c,e,f),r&&r.m(c,f),g(c,n,f),u[t].m(c,f),g(c,s,f),a=!0},p(c,[f]){var m;((m=c[7])==null?void 0:m.state)==="registration"?r||(r=We(),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null);let p=t;t=h(c),t===p?u[t].p(c,f):(se(),D(u[p],1,1,()=>{u[p]=null}),ie(),i=u[t],i?i.p(c,f):(i=u[t]=o[t](c),i.c()),E(i,1),i.m(s.parentNode,s))},i(c){a||(E(i),a=!0)},o(c){D(i),a=!1},d(c){c&&_(e),r&&r.d(c),c&&_(n),u[t].d(c),c&&_(s)}}}const ke=500;function mn(l,e,n){let t,i,s,a,r,o,u=k,h=()=>(u(),u=wt(i,z=>n(9,o=z)),i);fe(l,He,z=>n(1,s=z)),fe(l,Tt,z=>n(7,a=z)),fe(l,Le,z=>n(8,r=z)),l.$$.on_destroy.push(()=>u());let d;const c=new Re,f=new Y(12626431,.8);f.position.set(2.5,2.5,2),c.add(f);const p=new Y(16765393,.8);p.position.set(-2.5,2.5,2),c.add(p);const m=new Y(16777215,1);m.position.set(1,1,-1.5),c.add(m);let y=!0;const T=ke;let A=0,j=0,$=!1;const I=new Ie(50,ke/T,.1,1e3);I.position.set(0,0,1);let S;async function W(){const z=await je.loadHat(),_e=z.scene.children[0].children[1],le=z.scene.children[0].children[0];S.setSkeleton(le),_e.geometry.computeBoundingBox();const Q=new yt,ae=_e.geometry.boundingBox;ae.getCenter(Q),I.position.x=Q.x,I.position.y=Q.y;const st=(ae.max.y-Q.y)*4/2/Math.tan(Math.PI*I.fov/360);I.position.z=st,c.add(z.scene),n(3,$=!0)}oe(()=>{W();const z=new Ne({canvas:d,alpha:!0});z.setSize(ke,T),n(4,S=new Jt({scene:c,renderer:z,camera:I})),Yt(S).setActive();function le(ae){requestAnimationFrame(le),S==null||S.update(ae),A=V(de.x,A,.1),j=V(de.y,j,.1),I.position.x=A*-.8,I.position.y=j*.3+.1,I.lookAt(0,.2,0),Q()}function Q(){z.render(c,I)}le(0)});function Xe(z){X[z?"unshift":"push"](()=>{d=z,n(2,d)})}const Ze=()=>{S.params.wiggleRim<1&&(n(4,S.params.wiggleRim=5,S),n(4,S.params.wiggleEyes=1,S),setTimeout(()=>{n(4,S.params.wiggleRim=0,S),n(4,S.params.wiggleEyes=0,S)},1e3))},et=()=>s.start(),tt=z=>z.action.start(),nt=z=>{s.handleElementCallback(z)};function it(z){y=z,n(0,y)}return l.$$.update=()=>{l.$$.dirty&1&&n(6,t=y===!0||y===void 0),l.$$.dirty&2&&h(n(5,i=s&&s.state))},[y,s,d,$,S,i,t,a,r,o,Xe,Ze,et,tt,nt,it]}class Tn extends U{constructor(e){super();q(this,e,mn,pn,P,{})}}export{Tn as default};
